Search.setIndex({"docnames": ["api", "api/mesa.ecospatial.calculate_DPI", "api/mesa.ecospatial.calculate_GDI", "api/mesa.ecospatial.calculate_MDI", "api/mesa.ecospatial.calculate_diversity_index", "api/mesa.ecospatial.calculate_shannon_entropy", "api/mesa.ecospatial.diversity_heatmap", "api/mesa.ecospatial.generate_patches", "api/mesa.ecospatial.global_spatial_stats", "api/mesa.ecospatial.local_spatial_stats", "api/mesa.ecospatial.spot_cellfreq", "api/mesa.multiomics.multiomics_spatial.get_avg_expression_neighbors", "api/mesa.multiomics.multiomics_spatial.get_global_neighborhood_composition", "api/mesa.multiomics.multiomics_spatial.get_neighborhood_composition", "api/mesa.multiomics.multiomics_spatial.get_spatial_knn_indices", "index", "installation", "notebooks/tutorials/MESA_in_R", "notebooks/tutorials/MESA_tutorial_ecospatial", "notebooks/tutorials/MESA_tutorial_multiomics", "notebooks/unit_test/test_Calculate_MDI", "notebooks/unit_test/test_calculate_diversity_index", "notebooks/unit_test/test_generate_patches", "notebooks/unit_test/test_generate_patches_randomly", "tutorials", "unit_test"], "filenames": ["api.rst", "api/mesa.ecospatial.calculate_DPI.rst", "api/mesa.ecospatial.calculate_GDI.rst", "api/mesa.ecospatial.calculate_MDI.rst", "api/mesa.ecospatial.calculate_diversity_index.rst", "api/mesa.ecospatial.calculate_shannon_entropy.rst", "api/mesa.ecospatial.diversity_heatmap.rst", "api/mesa.ecospatial.generate_patches.rst", "api/mesa.ecospatial.global_spatial_stats.rst", "api/mesa.ecospatial.local_spatial_stats.rst", "api/mesa.ecospatial.spot_cellfreq.rst", "api/mesa.multiomics.multiomics_spatial.get_avg_expression_neighbors.rst", "api/mesa.multiomics.multiomics_spatial.get_global_neighborhood_composition.rst", "api/mesa.multiomics.multiomics_spatial.get_neighborhood_composition.rst", "api/mesa.multiomics.multiomics_spatial.get_spatial_knn_indices.rst", "index.rst", "installation.rst", "notebooks/tutorials/MESA_in_R.rst", "notebooks/tutorials/MESA_tutorial_ecospatial.ipynb", "notebooks/tutorials/MESA_tutorial_multiomics.ipynb", "notebooks/unit_test/test_Calculate_MDI.ipynb", "notebooks/unit_test/test_calculate_diversity_index.ipynb", "notebooks/unit_test/test_generate_patches.ipynb", "notebooks/unit_test/test_generate_patches_randomly.ipynb", "tutorials.rst", "unit_test.rst"], "titles": ["API", "mesa.ecospatial.calculate_DPI", "mesa.ecospatial.calculate_GDI", "mesa.ecospatial.calculate_MDI", "mesa.ecospatial.calculate_diversity_index", "mesa.ecospatial.calculate_shannon_entropy", "mesa.ecospatial.diversity_heatmap", "mesa.ecospatial.generate_patches", "mesa.ecospatial.global_spatial_stats", "mesa.ecospatial.local_spatial_stats", "mesa.ecospatial.spot_cellfreq", "mesa.multiomics.multiomics_spatial.get_avg_expression_neighbors", "mesa.multiomics.multiomics_spatial.get_global_neighborhood_composition", "mesa.multiomics.multiomics_spatial.get_neighborhood_composition", "mesa.multiomics.multiomics_spatial.get_spatial_knn_indices", "MESA - Multiomics and Ecological Spatial Analysis for Quantitative Decoding of Tissue Disease States in Python", "Installation", "Using MESA in R", "MESA Ecospatial Tutorials", "MESA Multiomics Tutorials", "Unit Test for Calculate_MDI", "Unit Test for calculate_diversity_index", "Unit Test for generate_patches", "Unit Test for generate_patches_randomly", "Tutorials", "UnitTest"], "terms": {"import": [0, 17, 18, 19, 20, 21, 22, 23], "mesa": [0, 16, 20, 21, 22, 23, 24], "m": 0, "spatial_data": [1, 2, 3, 4, 6, 7, 10, 17, 18, 20, 21, 22, 23], "scale": [1, 2, 3, 7, 10, 15, 17, 18, 19, 20], "library_kei": [1, 2, 3, 4, 6, 7, 10, 17, 18, 20, 21, 22, 23], "library_id": [1, 2, 3, 4, 6, 7, 10, 17, 18, 20, 21, 22, 23], "spatial_kei": [1, 2, 3, 4, 6, 7, 10, 17, 18, 20, 21, 22, 23], "cluster_kei": [1, 2, 3, 4, 10, 17, 18, 20, 21, 22, 23], "hotspot": [1, 2, 9, 18], "true": [1, 2, 4, 6, 8, 9, 10, 12, 17, 18, 19, 20, 21, 22, 23], "p_valu": [1, 2, 9, 10, 17, 18], "0": [1, 2, 9, 10, 17, 18, 19, 20, 21, 22, 23], "01": [1, 2, 9, 10, 18], "mode": [1, 2, 8, 9, 10, 18], "morani": [1, 2, 8, 9, 10, 18], "restrict": [1, 2, 8, 9, 10, 18], "fals": [1, 2, 3, 4, 6, 8, 9, 10, 17, 18, 19, 20, 21, 22, 23], "kwarg": [1, 2, 10], "calcul": [1, 2, 3, 4, 5, 8, 11, 12, 19, 24], "divers": [1, 2, 3, 4, 6, 8, 9, 15, 17, 18, 20, 21], "proxim": [1, 14], "index": [1, 2, 3, 4, 6, 15, 17, 18, 19, 20, 21, 22, 23], "dpi": [1, 19, 24], "specifi": [1, 2, 3, 4, 10, 12, 19], "sampl": [1, 2, 12, 13, 14, 17, 21, 24], "within": [1, 2, 3, 4, 6, 7, 10, 13, 15, 17, 23], "spatial": [1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 17, 18, 19, 22, 23], "data": [1, 2, 3, 4, 6, 7, 10, 11, 14, 15, 20, 21, 22, 23, 24], "paramet": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 19, 23], "union": [1, 2, 3, 4, 6, 7, 10, 18], "ad": [1, 2, 3, 4, 6, 7, 10, 17, 18, 19, 20, 21, 22, 23], "anndata": [1, 2, 3, 4, 6, 7, 10, 17, 18, 19, 20, 21, 22, 23], "pd": [1, 2, 3, 4, 6, 7, 10, 11, 18, 19, 20, 21, 22, 23], "datafram": [1, 2, 3, 4, 6, 7, 10, 11, 19, 20, 21, 22, 23, 24], "The": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 18, 19, 20, 21, 22, 23], "analyz": [1, 2, 4, 6, 10], "thi": [1, 4, 6, 7, 12, 15, 17, 18, 19, 20, 21, 22, 23], "can": [1, 4, 6, 7, 17, 19], "an": [1, 3, 4, 5, 6, 7, 11, 12, 13, 14, 15, 21], "object": [1, 4, 6, 7, 19, 21, 22, 23], "panda": [1, 2, 3, 6, 10, 18, 19, 20, 21, 22, 23], "float": [1, 2, 5, 7, 8, 9, 10], "factor": [1, 2, 7, 10], "us": [1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 15, 18, 19, 20, 21, 22, 23, 24], "gener": [1, 3, 7, 18, 19, 22, 23], "patch": [1, 3, 4, 6, 7, 18, 20, 21, 22, 23], "region": [1, 2, 4, 6, 8, 9, 10, 12, 18, 20], "str": [1, 2, 3, 4, 6, 7, 8, 9, 10, 14, 18, 19, 21, 22, 23], "kei": [1, 2, 3, 4, 6, 7, 10, 22], "correspond": [1, 6, 14, 19], "librari": [1, 2, 3, 4, 6, 7, 10, 17], "identifi": [1, 2, 3, 4, 6, 7, 9, 10, 14, 18], "tupl": [1, 2, 3, 8, 9, 10, 18], "list": [1, 2, 3, 4, 6, 7, 10, 19, 20, 21, 22, 23], "A": [1, 2, 3, 6, 7, 9, 10, 19, 21], "process": [1, 11, 19, 20, 24], "": [1, 2, 3, 4, 6, 7, 10, 15, 17, 18, 24], "determin": [1, 2, 7, 9, 12, 13, 19], "coordin": [1, 2, 4, 10, 22], "differ": [1, 10, 19], "cluster": [1, 2, 3, 4, 10, 12, 13, 19], "type": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 19, 21, 22, 23], "bool": [1, 2, 3, 4, 6, 8, 9, 10, 12, 18], "option": [1, 2, 3, 4, 6, 8, 9, 10, 12, 14, 19], "whether": [1, 2, 3, 12], "coldspot": [1, 2, 9, 24], "default": [1, 2, 3, 4, 6, 8, 9, 10, 12, 14, 18], "i": [1, 2, 3, 4, 6, 8, 9, 10, 12, 14, 15, 18, 20, 21, 22, 23, 24], "signific": [1, 2, 8, 9, 10], "level": [1, 6, 18, 19], "identif": 1, "statist": [1, 2, 8, 9, 10, 18, 24], "If": [1, 4, 6, 8, 9, 10, 18, 19], "set": [1, 4, 5, 8, 9, 10, 15, 18, 19, 20, 21, 22, 23], "analysi": [1, 2, 3, 6, 8, 9, 10, 17, 19, 24], "specif": [1, 2, 6, 7, 10, 12, 15, 18], "tissu": [1, 2, 6, 8, 9, 10, 18], "addit": [1, 2, 3, 4, 10, 15], "keyword": [1, 2, 3, 10], "argument": [1, 2, 3, 10, 19], "further": [1, 6, 10, 15], "custom": [1, 2, 6, 10, 18, 19], "return": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 18, 19, 23], "where": [1, 6, 12, 13, 14, 19], "each": [1, 2, 3, 4, 5, 6, 7, 10, 11, 12, 13, 14, 18, 19, 23], "repres": [1, 2, 5, 6, 11, 12, 13, 14], "column": [1, 2, 11, 17, 18, 19, 20], "contain": [1, 2, 3, 4, 8, 9, 10, 18, 19, 23], "whole_tissu": 2, "global": [2, 8, 10, 12, 15, 24], "gdi": [2, 24], "incorpor": [2, 15], "under": [2, 15, 20], "chosen": [2, 9], "inform": [2, 6, 7, 10, 15, 19], "adjust": [2, 10], "associ": [2, 6, 8, 9, 10], "access": [2, 3, 4, 6, 7, 10, 22], "entir": [2, 10, 12], "p": [2, 8, 9, 10, 17, 18], "valu": [2, 3, 6, 8, 9, 10, 11, 17, 18, 19, 22, 23], "threshold": [2, 10, 18], "condit": [2, 10, 17, 18], "underli": [2, 10], "function": [2, 10, 15, 20, 23], "indic": [2, 3, 4, 6, 8, 9, 11, 12, 13, 14, 15, 18, 19, 21], "singl": [2, 11, 15, 18], "random_patch": [3, 17, 18, 20], "plotfig": [3, 17, 18, 20], "savefig": [3, 17, 18, 19, 20], "patch_kwarg": [3, 17, 18, 20], "other_kwarg": [3, 17, 18, 20], "multiscal": [3, 17], "mdi": [3, 24], "which": [3, 5, 7, 17, 19], "involv": [3, 19], "from": [3, 5, 7, 15, 18, 19, 20, 21, 22, 23], "categor": 3, "entiti": 3, "should": [3, 18, 19, 20, 21, 22, 23], "random": [3, 9, 19, 20, 22, 23], "manner": 3, "plot": [3, 6, 19, 24], "figur": [3, 6, 18, 19], "dure": [3, 19], "save": [3, 19], "disk": 3, "dict": [3, 17, 18], "empti": [3, 18, 20, 21, 22, 23], "dictionari": 3, "other": [3, 17, 18, 19], "mai": [3, 19], "influenc": 3, "overal": 3, "metric": [4, 15, 17, 18, 21], "shannon": [4, 5, 17, 18, 21], "return_comp": [4, 18, 21], "heterogen": [4, 6, 18], "either": [4, 6, 7, 12, 19, 21], "relat": 4, "comput": [4, 9, 12, 13, 14, 19], "defin": [4, 7, 15, 18], "group": [4, 18], "e": [4, 10, 11], "g": [4, 10, 11], "comprehens": 4, "result": [4, 10, 11, 18, 19, 20, 21, 22, 23, 24], "detail": [4, 15, 17, 19], "along": [4, 9, 19], "seri": [4, 6, 18, 21, 22], "cell": [4, 6, 10, 11, 15, 19, 24], "composit": [4, 12, 13, 18, 24], "count": [5, 12, 19], "entropi": 5, "numpi": [5, 6, 8, 9, 12, 13, 14, 18, 19, 20, 21, 22, 23], "ndarrai": [5, 6, 8, 9, 11, 12, 13, 14], "arrai": [5, 9, 12, 13, 14, 19, 21], "frequenc": [5, 10, 24], "distinct": [5, 19], "event": 5, "dataset": [5, 12, 19], "heterogeneity_indic": [6, 18], "tissue_onli": [6, 8, 9, 18], "return_fig": [6, 18], "visual": [6, 8, 9, 17, 18, 19], "heatmap": [6, 18, 24], "origin": 6, "its": 6, "onli": [6, 8, 9, 15, 18, 19], "ar": [6, 7, 10, 18, 19, 20, 21, 23], "includ": [6, 8, 9, 14, 19], "matplotlib": [6, 18, 19], "none": [6, 10, 18, 19], "grid": [6, 8, 9, 18], "both": [6, 18, 19, 20, 21, 22, 23], "scaling_factor": [7, 18, 22, 23], "them": [7, 18], "accord": 7, "given": [7, 14], "segreg": 7, "subset": [7, 17, 18, 19, 22, 23], "int": [7, 9, 10, 14, 18], "dimens": 7, "size": [7, 17, 18, 19, 20, 22, 23], "deriv": 7, "plot_weight": [8, 9, 18], "perform": [8, 19, 24], "autocorrel": [8, 9], "2d": [8, 9, 14, 18], "method": [8, 9, 14, 18, 19], "gearyc": [8, 9], "getisordg": [8, 9], "exclud": 8, "non": [8, 22, 23], "area": [8, 22], "weight": [8, 9], "matrix": [8, 9, 14, 18, 19], "help": 8, "understand": [8, 9, 15], "relationship": [8, 9], "degre": 8, "test": [8, 10, 18, 24, 25], "seed": [9, 18, 22, 23], "42": [9, 18, 19, 22, 23], "return_stat": [9, 18], "local": [9, 15, 18, 24], "lisa": [9, 18], "base": [9, 12, 13, 17, 18, 24], "cutoff": 9, "ensur": 9, "reproduc": [9, 22, 23], "aid": 9, "boolean": 9, "locat": [9, 14, 19], "high": [9, 23], "surround": 9, "low": [9, 19], "spot": [10, 18], "hot": [10, 24], "combin": [10, 18], "2": [10, 14, 17, 18, 19, 20, 21, 22, 23], "top": [10, 18, 19], "15": [10, 14, 18, 19], "selected_comb": [10, 18], "co": [10, 24], "occurr": [10, 24], "across": [10, 12, 15, 19], "cold": [10, 18], "number": [10, 14, 18, 19, 20], "consid": [10, 18], "appli": [10, 18, 19], "normal": [10, 19], "select": [10, 18, 19], "transpos": 10, "show": [10, 18, 19], "sort": [10, 18, 19], "exp_df": 11, "spatial_knn_indic": [11, 19], "averag": [11, 24], "express": [11, 15, 24], "over": 11, "neighbor": [11, 12, 13, 14, 19], "point": [11, 14, 18, 19, 20, 21, 22, 23], "row": [11, 12, 13, 14, 18, 19], "attribut": 11, "gene": [11, 15, 19], "np": [11, 18, 19, 20, 21, 22, 23], "k": [11, 12, 13, 14, 18, 19], "nearest": [11, 12, 13, 14, 19], "structur": 11, "knn_indic": [12, 13, 19], "label": [12, 13, 17, 18, 19, 22], "all_label": 12, "percentag": 12, "form": 12, "nn": [12, 13, 14], "shape": [12, 13, 14, 17, 18, 19, 20, 21, 22, 23], "n_sampl": [12, 13, 14], "n_neighbor": [12, 13, 14, 19], "appear": 12, "particular": 12, "neighborhood": [12, 13, 15, 24], "all": [12, 19, 20, 21, 22, 23, 24], "uniqu": [12, 17, 18, 19], "refer": 12, "total": [12, 19, 23], "raw": 12, "len": [12, 18, 19, 21, 22, 23], "proport": 13, "kd_tree": [14, 19], "space": 14, "ball_tre": 14, "brute": 14, "order": [14, 18, 19], "novel": 15, "pipelin": [15, 19], "bring": 15, "principl": 15, "togeth": 15, "integr": [15, 24], "therebi": 15, "enabl": 15, "deeper": 15, "more": [15, 19, 22, 23], "shift": 15, "remodel": 15, "draw": 15, "inspir": 15, "studi": 15, "adapt": 15, "tradition": 15, "gaug": 15, "biodivers": 15, "omic": [15, 19], "creat": [15, 17, 18, 21, 22, 23], "tool": 15, "systemat": 15, "quantif": 15, "cellular": [15, 24], "we": [15, 19], "introduc": 15, "multi": [15, 18], "alongsid": [15, 17], "captur": [15, 19], "overarch": 15, "also": [15, 19], "pattern": [15, 18, 20, 21, 22, 23], "depend": 15, "furthermor": 15, "emploi": 15, "approach": [15, 17], "analys": 15, "silico": [15, 19], "amalgam": 15, "cross": [15, 19], "modal": [15, 19], "enrich": 15, "context": [15, 21], "observ": [15, 19], "With": 15, "layer": 15, "brought": 15, "bear": 15, "facilit": 15, "extend": [15, 18], "view": 15, "interact": 15, "microenviron": 15, "differenti": 15, "ligand": 15, "receptor": 15, "assembli": 15, "enhanc": 15, "mechanist": 15, "brows": 15, "tutori": 15, "project": 15, "activ": [15, 19], "develop": 15, "academ": 15, "softwar": 15, "agreement": 15, "pleas": [15, 18, 19, 20, 21, 22, 23], "accordingli": 15, "run": [16, 17, 19, 20, 21, 22, 23], "pip": 16, "py": [16, 18, 20, 21, 22, 23], "To": [17, 18, 19, 22], "you": [17, 19], "util": [17, 19, 23], "reticul": 17, "provid": 17, "bridg": 17, "between": [17, 18, 19, 20, 21, 22, 23], "python": 17, "here": [17, 19], "how": [17, 19], "get": [17, 19], "start": 17, "instal": [17, 19], "modul": 17, "need": [17, 19], "For": [17, 19, 21, 22, 23], "exampl": [17, 19], "ecolog": 17, "eco": [17, 18, 20, 21], "ecospati": [17, 20, 21, 22, 23, 24], "now": [17, 19], "model": [17, 19], "directli": [17, 19], "your": 17, "environ": 17, "allow": 17, "har": 17, "power": 17, "capabl": 17, "framework": 17, "see": [17, 19], "below": [17, 19], "dplyr": 17, "ggplot2": 17, "ggbeeswarm": 17, "adata": [17, 18, 19, 21, 22, 23], "read_h5ad": [17, 18], "user": [17, 18, 19, 20, 21, 22, 23], "emri": [17, 18], "dropbox": [17, 18], "spatial_augment": [17, 18], "codex_mouse_spleen": [17, 18], "h5ad": [17, 18], "obsm": [17, 18, 21, 22, 23], "1000": [17, 18, 20, 22, 23], "ob": [17, 18, 21, 22, 23], "vector": 17, "c": [17, 18], "1": [17, 18, 19, 20, 21, 22, 23], "4": [17, 18, 19, 20, 21, 22, 23], "8": [17, 18, 19, 20, 21, 22, 23], "16": [17, 18, 19, 20, 21, 22, 23], "32": [17, 18, 19], "64": [17, 18], "multiscale_divers": 17, "cell_typ": [17, 18], "random_se": [17, 18, 23], "null": 17, "min_point": [17, 18, 23], "mdi_result": [17, 18], "frame": 17, "t": [17, 18, 22], "colnam": 17, "add": [17, 18, 19], "sample_id": [17, 18], "na": 17, "rownam": 17, "assign": [17, 19], "mutat": 17, "case_when": 17, "grepl": 17, "balbc": [17, 18], "mrl": [17, 18], "two": [17, 19, 22, 23], "mdi_balbc": 17, "filter": [17, 18, 19], "pull": 17, "mdi_mrl": 17, "welch": 17, "t_test_result": 17, "var": [17, 18, 19, 22], "equal": 17, "boxplot": [17, 18], "swarmplot": [17, 18], "overlai": 17, "ggplot": 17, "ae": 17, "x": [17, 18, 19, 20, 22, 23], "y": [17, 18, 19, 20, 22, 23], "fill": [17, 18], "geom_boxplot": 17, "outlier": 17, "without": 17, "geom_beeswarm": 17, "color": [17, 19, 24], "alpha": [17, 18], "6": [17, 18, 19, 21], "swarm": 17, "lab": 17, "titl": [17, 18, 19], "theme_minim": 17, "annot": [17, 18], "text": [17, 18, 19], "5": [17, 18, 19, 20, 21, 22, 23], "max": [17, 18, 19, 22, 23], "paste0": 17, "round": 17, "3": [17, 18, 19, 20, 21, 22, 23], "black": [17, 18], "print": [17, 18, 19, 21], "seaborn": [18, 19], "sn": [18, 19], "scipi": [18, 19], "stat": 18, "pyplot": [18, 19], "plt": [18, 19], "mcolor": 18, "figaspect": 18, "o": [18, 19, 20, 21, 22, 23], "sy": [18, 19, 20, 21, 22, 23], "path": [18, 19, 20, 21, 22, 23], "append": [18, 19, 20, 21, 22, 23], "opt": [18, 20, 21, 22, 23], "miniconda3": [18, 20, 21, 22, 23], "env": [18, 20, 21, 22, 23], "lib": [18, 20, 21, 22, 23], "python3": [18, 20, 21, 22, 23], "11": [18, 19, 20, 21, 22, 23], "site": [18, 20, 21, 22, 23], "packag": [18, 19, 20, 21, 22, 23, 24], "geopanda": [18, 20, 21, 22, 23], "_compat": [18, 20, 21, 22, 23], "106": [18, 20, 21, 22, 23], "userwarn": [18, 20, 21, 22, 23], "geo": [18, 20, 21, 22, 23], "version": [18, 19, 20, 21, 22, 23], "capi": [18, 20, 21, 22, 23], "13": [18, 19, 20, 21, 22, 23], "incompat": [18, 20, 21, 22, 23], "pygeo": [18, 20, 21, 22, 23], "wa": [18, 19, 20, 21, 22, 23], "compil": [18, 20, 21, 22, 23], "10": [18, 19, 20, 21, 22, 23], "convers": [18, 19, 20, 21, 22, 23], "slow": [18, 20, 21, 22, 23], "warn": [18, 19, 20, 21, 22, 23], "omp": [18, 20, 21, 22, 23], "info": [18, 19, 20, 21, 22, 23], "276": [18, 20, 21, 22, 23], "omp_set_nest": [18, 20, 21, 22, 23], "routin": [18, 20, 21, 22, 23], "deprec": [18, 20, 21, 22, 23], "omp_set_max_active_level": [18, 20, 21, 22, 23], "instead": [18, 20, 21, 22, 23], "spaghetti": [18, 20, 21, 22, 23], "network": [18, 20, 21, 22, 23], "41": [18, 19, 20, 21, 22, 23], "futurewarn": [18, 20, 21, 22, 23], "next": [18, 19, 20, 21, 22, 23], "major": [18, 20, 21, 22, 23], "releas": [18, 20, 21, 22, 23], "pysal": [18, 20, 21, 22, 23], "drop": [18, 20, 21, 22, 23], "support": [18, 20, 21, 22, 23], "libpys": [18, 20, 21, 22, 23], "cg": [18, 20, 21, 22, 23], "geometri": [18, 20, 21, 22, 23], "chang": [18, 20, 21, 22, 23], "first": [18, 19, 20, 21, 22, 23], "step": [18, 20, 21, 22, 23, 24], "refactor": [18, 20, 21, 22, 23], "expect": [18, 20, 21, 22, 23], "dramat": [18, 20, 21, 22, 23], "reduc": [18, 19, 20, 21, 22, 23], "runtim": [18, 20, 21, 22, 23], "instanti": [18, 20, 21, 22, 23], "oper": [18, 19, 20, 21, 22, 23], "current": [18, 20, 21, 22, 23], "requir": [18, 20, 21, 22, 23], "input": [18, 19, 20, 21, 22, 23], "prepar": [18, 20, 21, 22, 23, 24], "simpli": [18, 20, 21, 22, 23], "convert": [18, 19, 20, 21, 22, 23], "dep_msg": [18, 20, 21, 22, 23], "stacklevel": [18, 20, 21, 22, 23], "rcparam": [18, 19], "font": [18, 19], "famili": [18, 19], "arial": [18, 19], "svg": [18, 19], "fonttyp": [18, 19], "keep": [18, 19], "unit": [18, 25], "micron": 18, "colormap": 18, "cell_nam": 18, "tolist": [18, 19], "tab10": 18, "tab20b": 18, "tab20c": 18, "extract": [18, 19, 22, 23], "19": [18, 19], "colors_from_tab20b": 18, "rang": [18, 19], "20": [18, 19, 23], "colors_from_tab20c": 18, "12": [18, 19], "custom_palett": 18, "colors_hex": 18, "rgb2hex": 18, "color_dict": 18, "zip": [18, 19], "cd4": [18, 19], "cd8": [18, 19], "31a354": 18, "cd106": 18, "cd16": [18, 19], "ly6c": 18, "cd31": [18, 19], "e7cb94": 18, "f4": 18, "80": 18, "mph": 18, "fdc": 18, "mhcii": 18, "637939": 18, "stroma": 18, "9": [18, 19, 20, 21], "noid": 18, "8c6d31": 18, "7": [18, 19], "fig": 18, "ax": [18, 19], "subplot": 18, "item": 18, "scatter": 18, "marker": [18, 19], "edgecolor": 18, "linewidth": 18, "legend": [18, 19], "loc": [18, 19], "center": [18, 19], "ncol": 18, "fontsiz": [18, 19], "small": 18, "axi": [18, 19, 21, 22, 23], "off": 18, "quardrat": 18, "patches_coordin": 18, "generate_patch": [18, 25], "sequenc": 18, "df_result": 18, "calculate_mdi": [18, 25], "000": [18, 20, 21], "per": [18, 20, 21], "cent": [18, 20, 21], "ha": [18, 19, 20], "zero": [18, 20, 22, 23], "diveristi": [18, 20], "4656779602794114": 18, "292377010141359": 18, "0901648127096593": 18, "8661607204492103": 18, "631288636532884": 18, "332991483128386": 18, "098": 18, "27": [18, 19], "8713334691757577": 18, "f": 18, "3f": 18, "466": 18, "cacul": 18, "quadrat": 18, "patch_indic": 18, "patches_comp": [18, 21], "calculate_diversity_index": [18, 25], "heatmap_fig": 18, "diversity_heatmap": 18, "moran": 18, "p_sim": 18, "global_spatial_stat": 18, "379": 18, "001": 18, "_": 18, "local_spatial_stat": 18, "signif_heatmap": 18, "discret": 18, "14": [18, 19, 23], "ldi": 18, "find": [18, 24], "visualis": 18, "combined_spot": 18, "seismic": 18, "cm": 18, "white": 18, "999": 18, "cmap": [18, 19], "linearsegmentedcolormap": 18, "from_list": 18, "custom_map": 18, "spatial_valu": [18, 23], "min_x": 18, "min_i": 18, "min": [18, 22, 23], "max_x": 18, "max_i": 18, "width": 18, "height": 18, "w": 18, "h": 18, "spot_fig": 18, "figsiz": [18, 19], "add_ax": 18, "diversity_index": 18, "enumer": [18, 23], "flatten": 18, "x0": [18, 21, 22, 23], "y0": [18, 21, 22, 23], "x1": [18, 21, 22, 23], "y1": [18, 21, 22, 23], "imshow": 18, "interpol": 18, "vmin": 18, "vmax": 18, "1768": 18, "140": 18, "1704": 18, "784": 18, "lt": [18, 19, 20, 21, 22, 23], "imag": 18, "axesimag": 18, "0x15239be50": 18, "gt": [18, 19, 20, 21, 22, 23], "proximity_i": 18, "calculate_dpi": 18, "331": 18, "61": 18, "island": 18, "183": [18, 21], "256": 18, "17": [18, 19], "similar": [18, 19], "distanc": 18, "pdist": 18, "squareform": 18, "labelled_hot": 18, "num_hot_island": 18, "_util": [18, 23], "_label_island": 18, "rook": 18, "labelled_cold": 18, "num_cold_island": 18, "aggreg": [18, 19], "filtered_patches_coordin": 18, "is_hotspot": 18, "filtered_patches_comp": 18, "island_comp": 18, "aggregate_spot_composit": 18, "els": [18, 19], "is_coldspot": 18, "head": [18, 19], "b": [18, 19, 21], "b220": 18, "dn": 18, "hi": 18, "vascular": 18, "cdc": 18, "ertr7": 18, "erythroblast": 18, "plasma": 18, "island_1": 18, "18": [18, 19], "23": [18, 19], "island_2": 18, "nan": 18, "island_3": 18, "29": [18, 19], "49": 18, "island_4": 18, "28": [18, 19], "46": [18, 19], "island_5": 18, "col": 18, "kind": 18, "barh": 18, "stack": [18, 19], "xlabel": [18, 19], "ylabel": [18, 19], "xtick": 18, "rotat": 18, "ytick": 18, "spine": 18, "set_vis": 18, "right": 18, "invert_yaxi": 18, "tight_layout": 18, "div": 18, "sum": 18, "island_comp_fil": 18, "fillna": 18, "brai": 18, "curti": 18, "braycurti": 18, "condens": 18, "squar": 18, "distance_matrix": 18, "mask": [18, 19], "upper": [18, 19], "triangl": 18, "triu": 18, "ones_lik": 18, "dtype": [18, 19, 20], "axis_label": 18, "arang": 18, "rocket": 18, "xticklabel": [18, 19], "yticklabel": [18, 19], "cbar_kw": 18, "shrink": 18, "dissimilar": 18, "make": [18, 19], "when": [18, 19, 22, 23], "8224049147168166": 18, "8742375282078143": 18, "8116755585127406": 18, "126137234736102": 18, "2585089241112524": 18, "3443099513229604": 18, "128433889698631": 18, "3719588637812334": 18, "8096339612313344": 18, "8382163972175585": 18, "741064715284067": 18, "0831593675761644": 18, "0598843042677837": 18, "0862452321757026": 18, "9923502002689952": 18, "200400887232563": 18, "6784053488305974": 18, "6853948865791275": 18, "6305199375873096": 18, "9864270563061894": 18, "8110161541535192": 18, "957160443128632": 18, "7304462437482897": 18, "0674673256522307": 18, "4799987919407114": 18, "562": 18, "5268685163240683": 18, "463874240684387": 18, "781459883250105": 18, "5436517302775545": 18, "74441429620238": 18, "491933508895646": 18, "8482716801311714": 18, "172": 18, "286806849622593": 18, "734": 18, "305147780044155": 18, "906": 18, "2551143500517985": 18, "5551198016811867": 18, "3339712388594913": 18, "5482756959354242": 18, "2869583672535363": 18, "6694817985568324": 18, "855": 18, "0660450865998814": 18, "395": 18, "077747085040528": 18, "250": 18, "0045285007782714": 18, "293": 18, "269587989274803": 18, "038872313385172": 18, "2839611402939903": 18, "0264183988555406": 18, "4175820356238615": 18, "222": 18, "7211111421043181": 18, "542": 18, "45": [18, 19], "7323775368753875": 18, "812": 18, "83": 18, "6591825505403395": 18, "708": 18, "51": 18, "7929988800461276": 18, "5852570804754544": 18, "220": 18, "30": [18, 19], "8367502236578277": 18, "69": 18, "6188286349155905": 18, "9853016901779386": 18, "slope": [18, 20], "822405": 18, "809634": 18, "678405": 18, "479999": 18, "286807": 18, "066045": 18, "721111": 18, "185095": 18, "874238": 18, "838216": 18, "685395": 18, "526869": 18, "305148": 18, "077747": 18, "732378": 18, "190242": 18, "811676": 18, "741065": 18, "63052": 18, "463874": 18, "255114": 18, "004529": 18, "659183": 18, "189498": 18, "126137": 18, "083159": 18, "986427": 18, "78146": 18, "55512": 18, "269588": 18, "792999": 18, "216352": 18, "258509": 18, "059884": 18, "811016": 18, "543652": 18, "333971": 18, "038872": 18, "585257": 18, "269244": 18, "34431": 18, "086245": 18, "95716": 18, "744414": 18, "548276": 18, "283961": 18, "83675": 18, "233433": 18, "128434": 18, "99235": 18, "730446": 18, "491934": 18, "286958": 18, "026418": 18, "618829": 18, "246577": 18, "465678": 18, "292377": 18, "090165": 18, "866161": 18, "631289": 18, "332991": 18, "871333": 18, "255739": 18, "371959": 18, "200401": 18, "067467": 18, "848272": 18, "669482": 18, "417582": 18, "985302": 18, "218700": 18, "gdi_result": 18, "calculate_gdi": 18, "639407": 18, "689433": 18, "696760": 18, "489871": 18, "465093": 18, "424368": 18, "463416": 18, "379494": 18, "433336": 18, "dpi_result": 18, "687": 18, "48": 18, "851": 18, "47": 18, "712": 18, "480": 18, "53": 18, "443": 18, "43": 18, "326": 18, "499": 18, "348": 18, "71": 18, "404": 18, "254256": 18, "506": 18, "251921": 18, "425": 18, "808947": 18, "270": 18, "151840": 18, "224": 18, "575542": 18, "135": [18, 20], "896041": 18, "262": 18, "844537": 18, "255600": 18, "208": 18, "151759": 18, "global_cellfreq_df": 18, "global_co_occurrence_df": 18, "spot_cellfreq": 18, "whole": 18, "global_co_occurrence_subcol": 18, "mean": [18, 19], "05": 18, "mous": 18, "melt": 18, "easier": 18, "global_cellfreq_df_melt": 18, "reset_index": [18, 22, 23], "id_var": 18, "003969": 18, "003772": 18, "005446": 18, "014466": 18, "019893": 18, "238": 18, "003016": 18, "239": 18, "013661": 18, "240": 18, "003686": 18, "241": 18, "016240": 18, "242": 18, "006100": 18, "243": 18, "selected_cell_typ": 18, "selected_p_valu": 18, "ct": 18, "group1": 18, "group2": 18, "t_stat": 18, "ttest_ind": 18, "equal_var": 18, "pvals_correct": 18, "false_discovery_control": 18, "bh": 18, "after": [18, 19], "correct": [18, 22, 23], "hue": [18, 19], "mute": 18, "boxprop": 18, "dodg": 18, "dark": 18, "auto": 18, "handl": 18, "get_legend_handles_label": 18, "handletextpad": 18, "columnspac": 18, "bbox_to_anchor": 18, "frameon": 18, "90": 18, "p_vals_corrected_dict": 18, "yrang": 18, "get_ylim": 18, "flush": 18, "axvlin": 18, "55": 18, "grei": 18, "linestyl": 18, "set_ylabel": 18, "set_xlabel": 18, "006408963135728074": 18, "08363460243637065": 18, "10246220899780342": 18, "04098951744156447": 18, "48760707221130684": 18, "00014746290448731814": 18, "029644306916028648": 18, "cd11c": 18, "04433015687789797": 18, "cd3": [18, 19], "0039461017917897965": 18, "744873603519344": 18, "23629828012676266": 18, "002101995902806824": 18, "27737999550550363": 18, "00013225110887609995": 18, "13322938432638706": 18, "8144572874311375": 18, "5151830491689221": 18, "010569967873872599": 18, "05479798379321029": 18, "nk": 18, "6906209729704317": 18, "capsul": 18, "03375417362245463": 18, "006927955270797655": 18, "granulocyt": 18, "550715896090467e": 18, "06": 18, "margin": 18, "zone": 18, "0024009677611480013": 18, "megakaryocyt": 18, "00616336220396191": 18, "0859271670427784": 18, "22183894046691652": 18, "021": 18, "136": 18, "154": 18, "085": 18, "572": 18, "073": 18, "018": 18, "774": 18, "304": 18, "013": 18, "340": 18, "189": 18, "814": 18, "580": 18, "029": 18, "099": 18, "746": 18, "076": 18, "299": 18, "spot_cellfreq_df": 18, "spot_co_occurrence_df": 18, "spot_co_occurrence_subcol": 18, "spot_cellfreq_df_melt": 18, "var_nam": [18, 19], "celltyp": 18, "value_nam": 18, "befor": [18, 19, 20], "df_melt": 18, "4f": 18, "df_filter": 18, "isin": 18, "spot_pvals_correct": 18, "map": 18, "lambda": [18, 19], "j": 18, "close": 18, "0000": 18, "0139": 18, "0097": 18, "0062": 18, "9028": 18, "0112": 18, "0295": 18, "0342": 18, "0460": 18, "0861": 18, "1443": 18, "0067": 18, "4478": 18, "0015": 18, "1899": 18, "2234": 18, "2324": 18, "0012": 18, "6537": 18, "2228": 18, "0739": 18, "0149": 18, "0010": 18, "0311": 18, "0195": 18, "3912": 18, "4404": 18, "040": 18, "037": 18, "030": 18, "903": 18, "038": 18, "065": 18, "066": 18, "083": 18, "137": 18, "216": 18, "484": 18, "010": 18, "285": 18, "679": 18, "125": 18, "048": 18, "459": 18, "union_col": 18, "have": [18, 19, 22, 23], "same": [18, 19, 23], "reindex": 18, "new_column": 18, "isinst": 18, "check": [18, 19, 20, 22, 23], "multiindex": 18, "join": [18, 19], "name": [18, 19], "strip": 18, "global_co_occurrence_df_singl": 18, "copi": [18, 19, 21, 22, 23], "global_co_occurrence_melt": 18, "amp": 18, "016479": 18, "025588": 18, "015360": 18, "059257": 18, "054832": 18, "976": 18, "021638": 18, "977": 18, "019085": 18, "978": 18, "021287": 18, "979": 18, "027615": 18, "980": 18, "045166": 18, "981": 18, "grai": 18, "034": 18, "161": 18, "008": 18, "053": 18, "236": 18, "006": 18, "686": 18, "003": 18, "004": 18, "033": 18, "031": 18, "960": 18, "232": 18, "041": 18, "022": 18, "002": 18, "114": 18, "024": 18, "579": 18, "660": 18, "005": 18, "479": 18, "124": 18, "035": 18, "231": 18, "007": 18, "009": 18, "100": [18, 19, 21], "077": 18, "142": [18, 22], "718": 18, "097": 18, "168": 18, "011": 18, "826": 18, "184": 18, "582": 18, "049": 18, "017": 18, "344": 18, "501": 18, "211": 18, "036": 18, "120": 18, "057": 18, "549": 18, "056": 18, "334": 18, "016": 18, "148": 18, "568": 18, "519": 18, "555": 18, "578": 18, "116": 18, "581": 18, "folder": [18, 22], "7g": [18, 22], "phdhh_ld3dlbnrst0t60bwzr0000gn": [18, 22], "ipykernel_23301": 18, "3825649457": 18, "22": [18, 19], "34": [18, 19, 21], "automat": 18, "grayscal": 18, "v0": 18, "39": [18, 19], "definit": 18, "062": 18, "212": 18, "019": 18, "286": 18, "706": 18, "014": 18, "061": 18, "059": 18, "068": 18, "045": 18, "165": 18, "063": 18, "610": 18, "685": 18, "015": 18, "556": 18, "173": 18, "149": 18, "118": 18, "290": 18, "193": 18, "731": 18, "146": 18, "218": 18, "025": 18, "834": 18, "079": 18, "012": 18, "204": 18, "403": 18, "575": 18, "265": 18, "169": 18, "088": 18, "156": 18, "396": 18, "043": 18, "263": 18, "199": 18, "589": 18, "166": 18, "spot_co_occurrence_df_singl": 18, "spot_co_occurrence_melt": 18, "040757": 18, "058754": 18, "042135": 18, "162500": 18, "128668": 18, "056433": 18, "052147": 18, "052104": 18, "057402": 18, "103448": 18, "hot_pvals_correct": 18, "highlighted_comb": 18, "split": [18, 19], "252": 18, "093": 18, "390": 18, "408": 18, "027": 18, "314": 18, "632": 18, "721": 18, "329": 18, "966": 18, "060": 18, "292": 18, "091": 18, "596": 18, "260": 18, "112": 18, "393": [18, 23], "954": 18, "677": 18, "448": 18, "153": 18, "899": 18, "259": 18, "829": 18, "350": 18, "475": 18, "234": 18, "1275659436": 18, "316": 18, "446": 18, "458": 18, "047": 18, "372": 18, "069": 18, "682": 18, "748": 18, "039": 18, "386": 18, "351": 18, "028": 18, "210": 18, "649": 18, "318": 18, "160": 18, "050": 18, "283": 18, "963": 18, "064": 18, "026": 18, "916": 18, "020": 18, "852": 18, "406": 18, "523": 18, "167": 18, "303": 18, "719": 18, "circoplot_df1": 18, "sort_index": 18, "groupbi": [18, 19], "set_index": 18, "073364": 18, "154887": 18, "256508": 18, "117092": 18, "026082": 18, "024203": 18, "609478": 18, "133404": 18, "033559": 18, "435705": 18, "037708": 18, "020787": 18, "11371": 18, "393021": 18, "120370": 18, "046403": 18, "097886": 18, "034235": 18, "101013": 18, "041810": 18, "190871": 18, "059676": 18, "186811": 18, "060700": 18, "051504": 18, "036226": 18, "382356": 18, "140771": 18, "115103": 18, "272822": 18, "102183": 18, "026166": 18, "04952": 18, "251273": 18, "133979": 18, "024188": 18, "089268": 18, "051191": 18, "250753": 18, "047435": 18, "109": 18, "426889": 18, "001323": 18, "199109": 18, "009298": 18, "001590": 18, "002537": 18, "000680": 18, "086876": 18, "018936": 18, "008218": 18, "002100": 18, "044063": 18, "009395": 18, "015804": 18, "001275": 18, "008339": 18, "003399": 18, "409448": 18, "001330": 18, "186915": 18, "008422": 18, "000598": 18, "002685": 18, "001306": 18, "088276": 18, "003174": 18, "015612": 18, "008544": 18, "003699": 18, "054574": 18, "013061": 18, "011742": 18, "000769": 18, "006286": 18, "400763": 18, "001408": 18, "223815": 18, "008694": 18, "001988": 18, "001457": 18, "000617": 18, "102824": 18, "001815": 18, "007768": 18, "006755": 18, "003940": 18, "051276": 18, "008200": 18, "016685": 18, "000667": 18, "007830": 18, "004224": 18, "378136": 18, "005246": 18, "075272": 18, "024428": 18, "002000": 18, "017725": 18, "002424": 18, "033211": 18, "001285": 18, "006200": 18, "011565": 18, "000927": 18, "214980": 18, "045479": 18, "008704": 18, "003683": 18, "012943": 18, "002159": 18, "218244": 18, "003634": 18, "135901": 18, "038220": 18, "003002": 18, "026945": 18, "001120": 18, "073725": 18, "000862": 18, "001135": 18, "008862": 18, "000187": 18, "287631": 18, "039742": 18, "003217": 18, "005458": 18, "007354": 18, "056364": 18, "255290": 18, "005701": 18, "201898": 18, "016811": 18, "000957": 18, "017219": 18, "001569": 18, "074642": 18, "001020": 18, "000804": 18, "005217": 18, "000217": 18, "149641": 18, "034974": 18, "002334": 18, "002755": 18, "009247": 18, "018444": 18, "130895": 18, "005161": 18, "224515": 18, "025679": 18, "003899": 18, "019769": 18, "001162": 18, "157824": 18, "000850": 18, "000175": 18, "005423": 18, "000150": 18, "259491": 18, "041686": 18, "000600": 18, "002612": 18, "006698": 18, "176714": 18, "179097": 18, "004766": 18, "177823": 18, "021902": 18, "001879": 18, "016291": 18, "011235": 18, "071379": 18, "000908": 18, "001715": 18, "007401": 18, "000353": 18, "139795": 18, "038192": 18, "003808": 18, "002396": 18, "012697": 18, "221316": 18, "027663": 18, "001739": 18, "207226": 18, "030473": 18, "001059": 18, "015451": 18, "005054": 18, "117974": 18, "000416": 18, "000101": 18, "005684": 18, "000466": 18, "084539": 18, "032880": 18, "000252": 18, "001979": 18, "010952": 18, "21": [18, 19], "circoplot_df2": 18, "004396": 18, "412367": 18, "001354": 18, "203280": 18, "008805": 18, "001392": 18, "002227": 18, "000868": 18, "092659": 18, "002509": 18, "026396": 18, "087874": 18, "014105": 18, "007839": 18, "003246": 18, "049971": 18, "010219": 18, "014744": 18, "000903": 18, "004050": 18, "084533": 18, "198221": 18, "004375": 18, "170439": 18, "026252": 18, "002132": 18, "018900": 18, "003761": 18, "088126": 18, "000890": 18, "032504": 18, "024637": 18, "001688": 18, "007359": 18, "000383": 18, "189346": 18, "038826": 18, "003152": 18, "003147": 18, "007477": 18, "26": [18, 19], "patient_group": 18, "create_circos_plot": 18, "cell_type_colors_hex": 18, "cell_abund": 18, "edge_weights_scal": 18, "highlighted_edg": 18, "node_weights_scal": 18, "5000": [18, 19, 20, 23], "figure_s": 18, "save_path": 18, "io": 19, "mmread": 19, "scanpi": 19, "sc": 19, "sklearn": 19, "kmean": 19, "tqdm": 19, "preprocess": 19, "minmaxscal": 19, "begin": 19, "read": [19, 24], "codex": 19, "scrnaseq": 19, "data_dir": 19, "tonsil": 19, "read_csv": 19, "tonsil_codex": 19, "csv": 19, "let": 19, "scatterplot": 19, "centroid_x": 19, "centroid_i": 19, "term": 19, "meta": 19, "take": 19, "featur": 19, "protein_featur": 19, "cd38": 19, "cd19": 19, "vimentin": 19, "cd22": 19, "ki67": 19, "cd90": 19, "cd123": 19, "cd15": 19, "cd152": 19, "cd21": 19, "cytokeratin": 19, "cd2": 19, "cd66": 19, "collagen": 19, "cd81": 19, "hla": 19, "dr": 19, "cd57": 19, "cd7": 19, "cd278": 19, "podoplanin": 19, "cd45ra": 19, "cd34": 19, "cd54": 19, "cd9": 19, "igm": 19, "cd117": 19, "cd56": 19, "cd279": 19, "cd45": 19, "cd49f": 19, "cd5": 19, "cd63": 19, "cd11b": 19, "cd1c": 19, "cd40": 19, "cd274": 19, "cd27": 19, "cd104": 19, "cd273": 19, "fapalpha": 19, "ecadherin": 19, "protein_adata": 19, "to_numpi": 19, "float32": 19, "Then": 19, "format": 19, "too": [19, 23], "rna": 19, "tonsil_rna_count": 19, "txt": 19, "spars": 19, "10k": 19, "rna_nam": 19, "tonsil_rna_nam": 19, "rna_adata": 19, "tocsr": 19, "rna_adata_raw": 19, "most": 19, "time": 19, "antibodi": 19, "construct": 19, "straight": 19, "forward": 19, "wai": 19, "file": 19, "seen": 19, "cite": 19, "seq": 19, "etc": 19, "protein_gene_convers": 19, "cd80": 19, "cd86": 19, "pdcd1lg2": 19, "cd275": 19, "icoslg": 19, "But": 19, "cours": 19, "doe": 19, "new": [19, 23], "assai": 19, "certain": 19, "found": [19, 21], "miss": [19, 21], "customli": 19, "rna_protein_correspond": 19, "curr_protein_nam": 19, "curr_rna_nam": 19, "iloc": [19, 22], "continu": 19, "ignor": [19, 20, 21, 22, 23], "some": 19, "eg": 19, "isoform": 19, "one": [19, 24], "multipl": 19, "r": [19, 24], "rna_shar": 19, "protein_shar": 19, "match": 19, "One": 19, "encount": 19, "variabl": 19, "fine": 19, "becaus": 19, "encod": 19, "vice": 19, "versa": 19, "sure": 19, "static": 19, "toarrai": 19, "std": 19, "12977": 19, "178919": 19, "standard": 19, "skip": 19, "alreadi": 19, "et": 19, "pp": 19, "normalize_tot": 19, "log1p": 19, "again": 19, "avail": 19, "measur": 19, "just": 19, "share": [19, 21], "ones": 19, "rna_act": 19, "protein_act": 19, "iter": 19, "highly_variable_gen": 19, "n_top_gen": 19, "retain": 19, "highli": 19, "highly_vari": 19, "1e": 19, "sinc": [19, 22, 23], "In": [19, 22], "illustr": 19, "maxfus": 19, "proce": 19, "ll": 19, "follow": 19, "outlin": 19, "while": 19, "implement": 19, "document": 19, "out": [19, 23], "http": 19, "readthedoc": 19, "en": 19, "latest": 19, "html": 19, "load": [19, 24], "ahead": 19, "mf": 19, "call": [19, 20], "constructor": 19, "fusor": 19, "main": [19, 20, 21, 22, 23], "shared_arr1": 19, "shared_arr2": 19, "active_arr1": 19, "active_arr2": 19, "labels1": 19, "labels2": 19, "complex": 19, "split_into_batch": 19, "fit": 19, "batch": 19, "max_outward_s": 19, "8000": 19, "matching_ratio": 19, "metacell_s": 19, "verbos": 19, "second": [19, 23], "35783": 19, "35787": 19, "appropri": 19, "graph": 19, "singular": 19, "mani": 19, "princip": 19, "compon": 19, "pc": 19, "do": 19, "avtive_arr1": 19, "plot_singular_valu": 19, "target": 19, "n_compon": 19, "explicitli": 19, "600x600": 19, "v": 19, "avtive_arr2": 19, "inspect": 19, "elbow": 19, "choos": 19, "40": 19, "construct_graph": 19, "n_neighbors1": 19, "n_neighbors2": 19, "svd_components1": 19, "svd_components2": 19, "resolution1": 19, "resolution2": 19, "resolut": 19, "less": 19, "than": [19, 23], "resolution_tol": 19, "distinguish": 19, "arr1": 19, "metacel": 19, "finish": 19, "arr2": 19, "whose": 19, "so": 19, "24": 19, "25": [19, 22, 23], "find_initial_pivot": 19, "pair": 19, "wt1": 19, "wt2": 19, "done": 19, "store": 19, "intern": 19, "field": 19, "_init_match": 19, "invis": 19, "canon": 19, "correl": 19, "best": 19, "cca": 19, "plot_canonical_correl": 19, "50": [19, 22, 23], "cca_compon": 19, "quick": 19, "previou": 19, "give": 19, "rough": 19, "guid": 19, "what": 19, "refine_pivot": 19, "pick": 19, "note": 19, "n_iter": 19, "snr": 19, "omi": 19, "increas": 19, "amount": 19, "might": 19, "degrad": 19, "randomized_svd": 19, "svd_run": 19, "filter_prop": 19, "compar": 19, "harsher": 19, "benefici": 19, "filter_bad_match": 19, "16245": 19, "32485": 19, "remain": 19, "score": 19, "9567": 19, "u": 19, "full": 19, "awai": 19, "few": 19, "scenario": 19, "would": 19, "prefer": 19, "accross": 19, "howev": 19, "case": 19, "invovl": 19, "noisi": 19, "lack": 19, "downstream": 19, "suggest": 19, "around": 19, "31": 19, "125238": 19, "178914": 19, "get_match": 19, "full_data": 19, "duplic": 19, "those": 19, "dealt": 19, "noth": 19, "potenti": 19, "least": [19, 23], "full_match": 19, "141438": 19, "mod": 19, "could": [19, 23], "33": [19, 21], "mod1_indx": 19, "mod2_indx": 19, "idx": 19, "mod1": 19, "mod2": 19, "11555": 19, "677698": 19, "12419": 19, "829264": 19, "6964": 19, "743796": 19, "12027": 19, "35": 19, "633725": 19, "3463": 19, "38": 19, "873877": 19, "141433": 19, "6516": 19, "178913": 19, "650691": 19, "141434": 19, "6380": 19, "178915": 19, "752489": 19, "141435": 19, "11798": 19, "178916": 19, "624662": 19, "141436": 19, "178917": 19, "598526": 19, "141437": 19, "6253": 19, "178918": 19, "721950": 19, "df_re": 19, "to_csv": 19, "tonsil_codex_rna": 19, "protein_exp": 19, "feature_label": 19, "multiomics_spati": 19, "get_spatial_knn_indic": 19, "cell_nbhd": 19, "get_neighborhood_composit": 19, "n_cluster": 19, "random_st": 19, "labels_": 19, "cluster_composit": 19, "astyp": [19, 22, 23], "cell_type_ord": 19, "order_clusters_composit": 19, "hue_ord": 19, "raster": 19, "tick_param": 19, "labels": 19, "centroid": 19, "left": 19, "get_titl": 19, "set_fonts": 19, "get_text": 19, "tonsil_ct_composit": 19, "png": 19, "300": 19, "avg_exp": 19, "get_avg_expression_neighbor": 19, "avg_exp_df": 19, "avg": 19, "00": 19, "5944": 19, "59it": 19, "kmeans_protein": 19, "cluster_protein": 19, "reorder": 19, "consist": [19, 22], "order_clusters_protein": 19, "cluster_protein_ord": 19, "index1": 19, "index2": 19, "index3": 19, "index4": 19, "index5": 19, "index6": 19, "index7": 19, "index8": 19, "palett": [19, 24], "bright": 19, "tonsil_avgprotein_ord": 19, "df_rna_match": 19, "2000": 19, "rna_exp": 19, "rna_match": 19, "desc": 19, "rna_idx": 19, "rna_exp_each": 19, "5625": 19, "78it": 19, "rna_matched_protein_ord": 19, "rna_matched_df": 19, "avg_exp_rna": 19, "avg_exp_rna_df": 19, "3908": 19, "42it": 19, "kmeans_rna": 19, "cluster_rna": 19, "order_clusters_rna": 19, "cluster_rna_ord": 19, "index9": 19, "index10": 19, "tonsil_avgrna_ord": 19, "all_protein": 19, "cluster_avg_exp": 19, "scaler": 19, "rna_matched_protein_order_scal": 19, "fit_transform": 19, "all_rna": 19, "cluster_avg_exp_rna": 19, "var_rna": 19, "top_variance_column": 19, "sort_valu": 19, "ascend": 19, "top_variance_column_nam": 19, "cluster_avg_exp_rna_vari": 19, "were": 19, "reveal": 19, "despit": 19, "discern": 19, "focal": 19, "intens": 19, "makeup": 19, "cd74": 19, "tuba1b": 19, "These": 19, "variat": 19, "known": 19, "subpopul": 19, "germin": 19, "comb_df": 19, "concat": 19, "fg": 19, "clustermap": 19, "blue": 19, "row_clust": 19, "col_clust": 19, "cax": 19, "yaxi": 19, "set_tick_param": 19, "ax_heatmap": 19, "set_yticklabel": 19, "get_yticklabel": 19, "set_xticklabel": 19, "get_xticklabel": 19, "tonsil_protein_neighborhood_heatmap": 19, "unittest": [20, 21, 22, 23], "mock": [20, 21], "class": [20, 21, 22, 23], "testcalculatemdi": 20, "testcas": [20, 21, 22, 23], "def": [20, 21, 22, 23], "setup": 20, "self": [20, 21, 22, 23], "up": [20, 21, 22, 23], "rand": [20, 22, 23], "sample_1": [20, 21, 22, 23], "2500": [20, 22], "sample_2": [20, 21, 23], "randint": [20, 22, 23], "expected_index": 20, "expected_column": 20, "test_calculate_mdi_with_random_patch_fals": 20, "assertisinst": [20, 21, 22, 23], "assertlistequ": 20, "verifi": 20, "exist": 20, "numer": [20, 22, 23], "assertin": [20, 21], "asserttru": [20, 23], "issubdtyp": 20, "test_calculate_mdi_with_random_patch_tru": 20, "result_random": 20, "notebook": [20, 21, 22, 23], "argv": [20, 21, 22, 23], "arg": [20, 21, 22, 23], "exit": [20, 21, 22, 23], "320548430536853": 20, "318675527712075": 20, "3157615698139944": 20, "3098586262794134": 20, "2738724660974885": 20, "2712741280351403": 20, "1357805949294244": 20, "136249663683922": 20, "5571428571428572": 20, "6714285714285715": 20, "319397130221288": 20, "3198048602087438": 20, "311824991920736": 20, "3127017488287462": 20, "2742115498481206": 20, "280909902805943": 20, "1625338119527555": 20, "153896959644078": 20, "ran": [20, 21, 22, 23], "ok": [20, 21, 22, 23], "testprogram": [20, 21, 22, 23], "0x150b6c9d0": 20, "testcalculatediversityindex": 21, "classmethod": [21, 22, 23], "setupclass": [21, 22, 23], "cl": [21, 22, 23], "among": 21, "cell1": 21, "cell2": 21, "cell3": 21, "cell4": 21, "cell5": 21, "df": [21, 22], "x_coord": 21, "y_coord": 21, "test_calculate_diversity_index_with_adata": 21, "assert": 21, "expected_entropy_patch0": 21, "calculate_shannon_entropi": 21, "assertalmostequ": [21, 22, 23], "assertnotin": 21, "expected_entropy_patch2": 21, "assertequ": [21, 22, 23], "test_calculate_diversity_index_with_datafram": 21, "test_invalid_metr": 21, "invalid": [21, 22, 23], "assertrais": [21, 22, 23], "valueerror": [21, 22, 23], "unknown": 21, "except": 21, "test_invalid_spatial_data": 21, "invalid_data": 21, "test_missing_cluster_kei": 21, "adata_missing_clust": 21, "inplac": [21, 22, 23], "test_empty_patch": 21, "empty_patch": 21, "test_return_comp_tru": 21, "result_seri": 21, "to_dict": 21, "assertisnon": 21, "test_metric_simpson": 21, "simpson": 21, "expected_simpson_patch0": 21, "calculate_simpson_index": 21, "expected_simpson_patch2": 21, "test_metric_simpson_divers": 21, "expected_simpson_diversity_patch0": 21, "calculate_simpsondiversity_index": 21, "expected_simpson_diversity_patch2": 21, "_core": 21, "implicitmodificationwarn": 21, "transform": 21, "082": 21, "333": 21, "0x151d4a150": 21, "testgeneratepatch": 22, "total_point": [22, 23], "spatial_coord": 22, "test_generate_patches_with_anndata": 22, "expected_patch": [22, 23], "2x2": 22, "test_generate_patches_with_datafram": 22, "5x5": [22, 23], "test_invalid_spatial_data_typ": [22, 23], "invalid_typ": [22, 23], "test_invalid_library_kei": [22, 23], "keyerror": [22, 23], "invalid_kei": [22, 23], "test_invalid_library_id": [22, 23], "invalid_id": [22, 23], "test_invalid_spatial_kei": [22, 23], "invalid_spatial_kei": [22, 23], "test_zero_scaling_factor": [22, 23], "test_non_numeric_scaling_factor": [22, 23], "typeerror": [22, 23], "test_empty_spatial_data_filt": [22, 23], "spatial_data_filt": [22, 23], "non_exist": [22, 23], "test_output_patch_coordin": 22, "min_coord": [22, 23], "max_coord": [22, 23], "expected_patch_width": [22, 23], "expected_patch_height": [22, 23], "cover": 22, "correctli": 22, "ipykernel_85830": 22, "3363036317": 22, "141": 22, "__getitem__": 22, "treat": 22, "posit": 22, "futur": 22, "integ": 22, "alwai": 22, "behavior": 22, "ser": 22, "po": 22, "055": 22, "0x158b78950": 22, "testgeneratepatchesrandomli": 23, "df_sample1": 23, "test_generate_patches_randomly_with_anndata": 23, "max_overlap": 23, "test_generate_patches_randomly_with_datafram": 23, "test_output_patch_s": 23, "place": 23, "test_max_overlap": 23, "overlap": 23, "patch1": 23, "patch2": 23, "overlap_check": 23, "overlap_allow": 23, "_overlap_check": 23, "new_patch": 23, "existing_patch": 23, "max_overlap_ratio": 23, "test_min_point": 23, "test_random_seed_consist": 23, "patches1": 23, "patches2": 23, "test_contains_min_point": 23, "_contains_point": 23, "0x15ba4a150": 23, "customis": 24, "circl": 24, "multiom": 24, "ii": 24, "initi": 24, "pivot": 24, "iii": 24, "refin": 24, "iv": 24, "propag": 24, "character": 24, "protein": 24, "mrna": 24, "generate_patches_randomli": 25}, "objects": {"mesa": [[0, 0, 0, "-", "ecospatial"]], "mesa.ecospatial": [[1, 1, 1, "", "calculate_DPI"], [2, 1, 1, "", "calculate_GDI"], [3, 1, 1, "", "calculate_MDI"], [4, 1, 1, "", "calculate_diversity_index"], [5, 1, 1, "", "calculate_shannon_entropy"], [6, 1, 1, "", "diversity_heatmap"], [7, 1, 1, "", "generate_patches"], [8, 1, 1, "", "global_spatial_stats"], [9, 1, 1, "", "local_spatial_stats"], [10, 1, 1, "", "spot_cellfreq"]], "mesa.multiomics": [[0, 0, 0, "-", "multiomics_spatial"]], "mesa.multiomics.multiomics_spatial": [[11, 1, 1, "", "get_avg_expression_neighbors"], [12, 1, 1, "", "get_global_neighborhood_composition"], [13, 1, 1, "", "get_neighborhood_composition"], [14, 1, 1, "", "get_spatial_knn_indices"]]}, "objtypes": {"0": "py:module", "1": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"]}, "titleterms": {"api": 0, "multiom": [0, 11, 12, 13, 14, 15, 19], "ecospati": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 18], "mesa": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19], "calculate_dpi": 1, "calculate_gdi": 2, "calculate_mdi": [3, 20], "calculate_diversity_index": [4, 21], "calculate_shannon_entropi": 5, "diversity_heatmap": 6, "generate_patch": [7, 22], "global_spatial_stat": 8, "local_spatial_stat": 9, "spot_cellfreq": 10, "multiomics_spati": [11, 12, 13, 14], "get_avg_expression_neighbor": 11, "get_global_neighborhood_composit": 12, "get_neighborhood_composit": 13, "get_spatial_knn_indic": 14, "ecolog": 15, "spatial": 15, "analysi": [15, 18], "quantit": 15, "decod": 15, "tissu": 15, "diseas": 15, "state": 15, "python": 15, "get": 15, "start": 15, "licens": 15, "instal": 16, "pypi": 16, "us": 17, "r": 17, "load": 17, "packag": 17, "read": [17, 18], "prepar": [17, 19], "data": [17, 18, 19], "calcul": [17, 18], "mdi": [17, 18], "perform": [17, 18], "statist": 17, "test": [17, 20, 21, 22, 23], "plot": [17, 18], "result": 17, "tutori": [18, 19, 24], "customis": 18, "color": 18, "palett": 18, "one": 18, "sampl": 18, "all": 18, "gdi": 18, "dpi": 18, "global": 18, "cell": 18, "frequenc": 18, "co": 18, "occurr": 18, "hot": 18, "coldspot": 18, "process": 18, "datafram": 18, "circl": 18, "integr": 19, "step": 19, "i": 19, "ii": 19, "find": 19, "initi": 19, "pivot": 19, "iii": 19, "refin": 19, "iv": 19, "propag": 19, "neighborhood": 19, "character": 19, "cellular": 19, "composit": 19, "base": 19, "": 19, "local": 19, "averag": 19, "protein": 19, "express": 19, "mrna": 19, "heatmap": 19, "unit": [20, 21, 22, 23], "generate_patches_randomli": 23, "unittest": 25}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "nbsphinx": 4, "sphinx": 60}, "alltitles": {"API": [[0, "api"]], "Multiomics": [[0, "module-mesa.multiomics.multiomics_spatial"]], "Ecospatial": [[0, "module-mesa.ecospatial"]], "mesa.ecospatial.calculate_DPI": [[1, "mesa-ecospatial-calculate-dpi"]], "mesa.ecospatial.calculate_GDI": [[2, "mesa-ecospatial-calculate-gdi"]], "mesa.ecospatial.calculate_MDI": [[3, "mesa-ecospatial-calculate-mdi"]], "mesa.ecospatial.calculate_diversity_index": [[4, "mesa-ecospatial-calculate-diversity-index"]], "mesa.ecospatial.calculate_shannon_entropy": [[5, "mesa-ecospatial-calculate-shannon-entropy"]], "mesa.ecospatial.diversity_heatmap": [[6, "mesa-ecospatial-diversity-heatmap"]], "mesa.ecospatial.generate_patches": [[7, "mesa-ecospatial-generate-patches"]], "mesa.ecospatial.global_spatial_stats": [[8, "mesa-ecospatial-global-spatial-stats"]], "mesa.ecospatial.local_spatial_stats": [[9, "mesa-ecospatial-local-spatial-stats"]], "mesa.ecospatial.spot_cellfreq": [[10, "mesa-ecospatial-spot-cellfreq"]], "mesa.multiomics.multiomics_spatial.get_avg_expression_neighbors": [[11, "mesa-multiomics-multiomics-spatial-get-avg-expression-neighbors"]], "mesa.multiomics.multiomics_spatial.get_global_neighborhood_composition": [[12, "mesa-multiomics-multiomics-spatial-get-global-neighborhood-composition"]], "mesa.multiomics.multiomics_spatial.get_neighborhood_composition": [[13, "mesa-multiomics-multiomics-spatial-get-neighborhood-composition"]], "mesa.multiomics.multiomics_spatial.get_spatial_knn_indices": [[14, "mesa-multiomics-multiomics-spatial-get-spatial-knn-indices"]], "MESA - Multiomics and Ecological Spatial Analysis for Quantitative Decoding of Tissue Disease States in Python": [[15, "mesa-multiomics-and-ecological-spatial-analysis-for-quantitative-decoding-of-tissue-disease-states-in-python"]], "Getting started with MESA": [[15, "getting-started-with-mesa"]], "License": [[15, "license"]], "Installation": [[16, "installation"]], "PyPI": [[16, "pypi"]], "Using MESA in R": [[17, "using-mesa-in-r"]], "Loading Packages": [[17, "loading-packages"]], "Read and prepare data": [[17, "read-and-prepare-data"]], "Calculate MDI": [[17, "calculate-mdi"], [18, "Calculate-MDI"]], "Perform statistical test and plot results": [[17, "perform-statistical-test-and-plot-results"]], "MESA Ecospatial Tutorials": [[18, "MESA-Ecospatial-Tutorials"]], "Read Data": [[18, "Read-Data"]], "Customise color palette": [[18, "Customise-color-palette"]], "Perform Ecospatial Analysis on one sample": [[18, "Perform-Ecospatial-Analysis-on-one-sample"]], "Perform Ecospatial Analysis on all samples": [[18, "Perform-Ecospatial-Analysis-on-all-samples"]], "Calculate GDI": [[18, "Calculate-GDI"]], "Calculate DPI": [[18, "Calculate-DPI"]], "Calculate Global Cell Frequency & Cell Co-Occurrence": [[18, "Calculate-Global-Cell-Frequency-&-Cell-Co-Occurrence"]], "Calculate Cell Frequency and Cell Co-Occurrence in hot/coldspots": [[18, "Calculate-Cell-Frequency-and-Cell-Co-Occurrence-in-hot/coldspots"]], "Process Cell Co-Occurrence Dataframe": [[18, "Process-Cell-Co-Occurrence-Dataframe"]], "Cell Co-Occurrence Circle Plot": [[18, "Cell-Co-Occurrence-Circle-Plot"]], "MESA Multiomics Tutorials": [[19, "MESA-Multiomics-Tutorials"]], "Prepare Data for Multiomics Integration": [[19, "Prepare-Data-for-Multiomics-Integration"]], "Multiomics Integration": [[19, "Multiomics-Integration"]], "Step I: preparations": [[19, "Step-I:-preparations"]], "Step II: finding initial pivots": [[19, "Step-II:-finding-initial-pivots"]], "Step III: finding refined pivots": [[19, "Step-III:-finding-refined-pivots"]], "Step IV: propagation": [[19, "Step-IV:-propagation"]], "Neighborhood Characterization": [[19, "Neighborhood-Characterization"]], "Cellular Composition-based Neighborhoods": [[19, "Cellular-Composition-based-Neighborhoods"]], "MESA\u2019s Local Average Protein Expression-based Neighborhoods": [[19, "MESA's-Local-Average-Protein-Expression-based-Neighborhoods"]], "MESA\u2019s Local Average mRNA Expression-based Neighborhoods": [[19, "MESA's-Local-Average-mRNA-Expression-based-Neighborhoods"]], "Neighborhood Heatmap": [[19, "Neighborhood-Heatmap"]], "Unit Test for Calculate_MDI": [[20, "Unit-Test-for-Calculate_MDI"]], "Unit Test for calculate_diversity_index": [[21, "Unit-Test-for-calculate_diversity_index"]], "Unit Test for generate_patches": [[22, "Unit-Test-for-generate_patches"]], "Unit Test for generate_patches_randomly": [[23, "Unit-Test-for-generate_patches_randomly"]], "Tutorials": [[24, "tutorials"]], "UnitTest": [[25, "unittest"]]}, "indexentries": {"mesa.ecospatial": [[0, "module-mesa.ecospatial"]], "mesa.multiomics.multiomics_spatial": [[0, "module-mesa.multiomics.multiomics_spatial"]], "module": [[0, "module-mesa.ecospatial"], [0, "module-mesa.multiomics.multiomics_spatial"]], "calculate_dpi() (in module mesa.ecospatial)": [[1, "mesa.ecospatial.calculate_DPI"]], "calculate_gdi() (in module mesa.ecospatial)": [[2, "mesa.ecospatial.calculate_GDI"]], "calculate_mdi() (in module mesa.ecospatial)": [[3, "mesa.ecospatial.calculate_MDI"]], "calculate_diversity_index() (in module mesa.ecospatial)": [[4, "mesa.ecospatial.calculate_diversity_index"]], "calculate_shannon_entropy() (in module mesa.ecospatial)": [[5, "mesa.ecospatial.calculate_shannon_entropy"]], "diversity_heatmap() (in module mesa.ecospatial)": [[6, "mesa.ecospatial.diversity_heatmap"]], "generate_patches() (in module mesa.ecospatial)": [[7, "mesa.ecospatial.generate_patches"]], "global_spatial_stats() (in module mesa.ecospatial)": [[8, "mesa.ecospatial.global_spatial_stats"]], "local_spatial_stats() (in module mesa.ecospatial)": [[9, "mesa.ecospatial.local_spatial_stats"]], "spot_cellfreq() (in module mesa.ecospatial)": [[10, "mesa.ecospatial.spot_cellfreq"]], "get_avg_expression_neighbors() (in module mesa.multiomics.multiomics_spatial)": [[11, "mesa.multiomics.multiomics_spatial.get_avg_expression_neighbors"]], "get_global_neighborhood_composition() (in module mesa.multiomics.multiomics_spatial)": [[12, "mesa.multiomics.multiomics_spatial.get_global_neighborhood_composition"]], "get_neighborhood_composition() (in module mesa.multiomics.multiomics_spatial)": [[13, "mesa.multiomics.multiomics_spatial.get_neighborhood_composition"]], "get_spatial_knn_indices() (in module mesa.multiomics.multiomics_spatial)": [[14, "mesa.multiomics.multiomics_spatial.get_spatial_knn_indices"]]}})