Search.setIndex({"docnames": ["api", "api/mesa.ecospatial.calculate_DPI", "api/mesa.ecospatial.calculate_GDI", "api/mesa.ecospatial.calculate_MDI", "api/mesa.ecospatial.calculate_diversity_index", "api/mesa.ecospatial.calculate_shannon_entropy", "api/mesa.ecospatial.diversity_heatmap", "api/mesa.ecospatial.generate_patches", "api/mesa.ecospatial.global_spatial_stats", "api/mesa.ecospatial.local_spatial_stats", "api/mesa.ecospatial.spot_cellfreq", "api/mesa.multiomics.multiomics_spatial.get_avg_expression_neighbors", "api/mesa.multiomics.multiomics_spatial.get_neighborhood_composition", "api/mesa.multiomics.multiomics_spatial.get_spatial_knn_indices", "index", "installation", "notebooks/tutorials/MESA_in_R", "notebooks/tutorials/MESA_tutorial_ecospatial", "notebooks/tutorials/MESA_tutorial_multiomics", "notebooks/unit_test/test_Calculate_MDI", "notebooks/unit_test/test_calculate_diversity_index", "notebooks/unit_test/test_generate_patches", "notebooks/unit_test/test_generate_patches_randomly", "tutorials", "unit_test"], "filenames": ["api.rst", "api/mesa.ecospatial.calculate_DPI.rst", "api/mesa.ecospatial.calculate_GDI.rst", "api/mesa.ecospatial.calculate_MDI.rst", "api/mesa.ecospatial.calculate_diversity_index.rst", "api/mesa.ecospatial.calculate_shannon_entropy.rst", "api/mesa.ecospatial.diversity_heatmap.rst", "api/mesa.ecospatial.generate_patches.rst", "api/mesa.ecospatial.global_spatial_stats.rst", "api/mesa.ecospatial.local_spatial_stats.rst", "api/mesa.ecospatial.spot_cellfreq.rst", "api/mesa.multiomics.multiomics_spatial.get_avg_expression_neighbors.rst", "api/mesa.multiomics.multiomics_spatial.get_neighborhood_composition.rst", "api/mesa.multiomics.multiomics_spatial.get_spatial_knn_indices.rst", "index.rst", "installation.rst", "notebooks/tutorials/MESA_in_R.rst", "notebooks/tutorials/MESA_tutorial_ecospatial.ipynb", "notebooks/tutorials/MESA_tutorial_multiomics.ipynb", "notebooks/unit_test/test_Calculate_MDI.ipynb", "notebooks/unit_test/test_calculate_diversity_index.ipynb", "notebooks/unit_test/test_generate_patches.ipynb", "notebooks/unit_test/test_generate_patches_randomly.ipynb", "tutorials.rst", "unit_test.rst"], "titles": ["API", "mesa.ecospatial.calculate_DPI", "mesa.ecospatial.calculate_GDI", "mesa.ecospatial.calculate_MDI", "mesa.ecospatial.calculate_diversity_index", "mesa.ecospatial.calculate_shannon_entropy", "mesa.ecospatial.diversity_heatmap", "mesa.ecospatial.generate_patches", "mesa.ecospatial.global_spatial_stats", "mesa.ecospatial.local_spatial_stats", "mesa.ecospatial.spot_cellfreq", "mesa.multiomics.multiomics_spatial.get_avg_expression_neighbors", "mesa.multiomics.multiomics_spatial.get_neighborhood_composition", "mesa.multiomics.multiomics_spatial.get_spatial_knn_indices", "MESA - Multiomics and Ecological Spatial Analysis for Quantitative Decoding of Tissue Disease States in Python", "Installation", "Using MESA in R", "MESA Ecospatial Tutorials", "MESA Multiomics Tutorials", "Unit Test for Calculate_MDI", "Unit Test for calculate_diversity_index", "Unit Test for generate_patches", "Unit Test for generate_patches_randomly", "Tutorials", "UnitTest"], "terms": {"import": [0, 16, 17, 18, 19, 20, 21, 22], "mesa": [0, 15, 19, 20, 21, 22, 23], "m": 0, "spatial_data": [1, 2, 3, 4, 6, 7, 10, 16, 17, 19, 20, 21, 22], "scale": [1, 2, 3, 7, 10, 14, 16, 17, 18, 19], "library_kei": [1, 2, 3, 4, 6, 7, 10, 16, 17, 19, 20, 21, 22], "library_id": [1, 2, 3, 4, 6, 7, 10, 16, 17, 19, 20, 21, 22], "spatial_kei": [1, 2, 3, 4, 6, 7, 10, 16, 17, 19, 20, 21, 22], "cluster_kei": [1, 2, 3, 4, 10, 16, 17, 19, 20, 21, 22], "hotspot": [1, 2, 9, 17], "true": [1, 2, 4, 6, 8, 9, 10, 12, 16, 17, 18, 19, 20, 21, 22], "p_valu": [1, 2, 9, 10, 16, 17], "0": [1, 2, 9, 10, 16, 17, 18, 19, 20, 21, 22], "01": [1, 2, 9, 10, 17], "mode": [1, 2, 8, 9, 10, 17], "morani": [1, 2, 8, 9, 10, 17], "restrict": [1, 2, 8, 9, 10, 17], "fals": [1, 2, 3, 4, 6, 8, 9, 10, 16, 17, 18, 19, 20, 21, 22], "kwarg": [1, 2, 10], "calcul": [1, 2, 3, 4, 5, 8, 11, 12, 18, 23], "divers": [1, 2, 3, 4, 6, 8, 9, 14, 16, 19, 20, 23], "proxim": [1, 13], "index": [1, 2, 3, 4, 6, 14, 16, 17, 18, 19, 20, 21, 22], "dpi": [1, 18, 23], "specifi": [1, 2, 3, 4, 10, 12, 18], "sampl": [1, 2, 12, 13, 16, 20, 23], "within": [1, 2, 3, 4, 6, 7, 10, 14, 16, 22], "spatial": [1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 16, 17, 18, 21, 22], "data": [1, 2, 3, 4, 6, 7, 10, 11, 13, 14, 19, 20, 21, 22, 23], "paramet": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 18, 22], "union": [1, 2, 3, 4, 6, 7, 10, 17], "ad": [1, 2, 3, 4, 6, 7, 10, 16, 17, 18, 19, 20, 21, 22], "anndata": [1, 2, 3, 4, 6, 7, 10, 16, 17, 18, 19, 20, 21, 22], "pd": [1, 2, 3, 4, 6, 7, 10, 11, 17, 18, 19, 20, 21, 22], "datafram": [1, 2, 3, 4, 6, 7, 10, 11, 18, 19, 20, 21, 22, 23], "The": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 17, 18, 19, 20, 21, 22], "analyz": [1, 2, 4, 6, 10], "thi": [1, 4, 6, 7, 12, 14, 16, 17, 18, 19, 20, 21, 22], "can": [1, 4, 6, 7, 16, 18], "an": [1, 3, 4, 5, 6, 7, 11, 12, 13, 14, 20], "object": [1, 4, 6, 7, 18, 20, 21, 22], "panda": [1, 2, 3, 6, 10, 17, 18, 19, 20, 21, 22], "float": [1, 2, 5, 7, 8, 9, 10], "factor": [1, 2, 7, 10], "us": [1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 19, 20, 21, 22, 23], "gener": [1, 3, 7, 17, 18, 21, 22], "patch": [1, 3, 4, 6, 7, 17, 19, 20, 21, 22], "region": [1, 2, 4, 6, 8, 9, 10, 12, 17, 19], "str": [1, 2, 3, 4, 6, 7, 8, 9, 10, 13, 17, 18, 20, 21, 22], "kei": [1, 2, 3, 4, 6, 7, 10, 21], "correspond": [1, 6, 13, 18], "librari": [1, 2, 3, 4, 6, 7, 10, 16], "identifi": [1, 2, 3, 4, 6, 7, 9, 10, 13, 17], "tupl": [1, 2, 3, 8, 9, 10, 17], "list": [1, 2, 3, 4, 6, 7, 10, 18, 19, 20, 21, 22], "A": [1, 2, 3, 6, 7, 9, 10, 18, 20], "process": [1, 11, 18, 19, 23], "": [1, 2, 3, 4, 6, 7, 10, 14, 16, 17, 23], "determin": [1, 2, 7, 9, 12, 18], "coordin": [1, 2, 4, 10, 17, 21], "differ": [1, 10, 18], "cluster": [1, 2, 3, 4, 10, 12, 18], "type": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 18, 20, 21, 22], "bool": [1, 2, 3, 4, 6, 8, 9, 10, 12, 17], "option": [1, 2, 3, 4, 6, 8, 9, 10, 12, 13, 18], "whether": [1, 2, 3, 12], "coldspot": [1, 2, 9, 23], "default": [1, 2, 3, 4, 6, 8, 9, 10, 12, 13, 17], "i": [1, 2, 3, 4, 6, 8, 9, 10, 12, 13, 14, 17, 19, 20, 21, 22, 23], "signific": [1, 2, 8, 9, 10], "level": [1, 6, 17, 18], "identif": 1, "statist": [1, 2, 8, 9, 10, 17, 23], "If": [1, 4, 6, 8, 9, 10, 17, 18], "set": [1, 4, 5, 8, 9, 10, 14, 17, 18, 19, 20, 21, 22], "analysi": [1, 2, 3, 6, 8, 9, 10, 16, 18, 23], "specif": [1, 2, 6, 7, 10, 12, 14, 17], "tissu": [1, 2, 6, 8, 9, 10, 17], "addit": [1, 2, 3, 4, 10, 14], "keyword": [1, 2, 3, 10], "argument": [1, 2, 3, 10, 18], "further": [1, 6, 10, 14], "custom": [1, 2, 6, 10, 17, 18], "return": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 17, 18, 22], "where": [1, 6, 12, 13, 17, 18], "each": [1, 2, 3, 4, 5, 6, 7, 10, 11, 12, 13, 17, 18, 22], "repres": [1, 2, 5, 6, 11, 12, 13], "column": [1, 2, 11, 16, 17, 18, 19], "contain": [1, 2, 3, 4, 8, 9, 10, 17, 18, 22], "whole_tissu": 2, "global": [2, 8, 10, 12, 14, 23], "gdi": [2, 23], "incorpor": [2, 14], "under": [2, 14, 19], "chosen": [2, 9], "inform": [2, 6, 7, 10, 14, 18], "adjust": [2, 10], "associ": [2, 6, 8, 9, 10], "access": [2, 3, 4, 6, 7, 10, 21], "entir": [2, 10, 12], "p": [2, 8, 9, 10, 16, 17], "valu": [2, 3, 6, 8, 9, 10, 11, 16, 17, 18, 21, 22], "threshold": [2, 10, 17], "condit": [2, 10, 16, 17], "underli": [2, 10], "function": [2, 10, 14, 19, 22], "indic": [2, 3, 4, 6, 8, 9, 11, 12, 13, 14, 17, 18, 20], "singl": [2, 11, 14, 17], "random_patch": [3, 16, 17, 19], "plotfig": [3, 16, 17, 19], "savefig": [3, 16, 17, 18, 19], "patch_kwarg": [3, 16, 17, 19], "other_kwarg": [3, 16, 17, 19], "multiscal": [3, 16], "mdi": [3, 23], "which": [3, 5, 7, 16, 18], "involv": [3, 18], "from": [3, 5, 7, 14, 17, 18, 19, 20, 21, 22], "categor": 3, "entiti": 3, "should": [3, 17, 18, 19, 20, 21, 22], "random": [3, 9, 18, 19, 21, 22], "manner": 3, "plot": [3, 6, 18, 23], "figur": [3, 6, 17, 18], "dure": [3, 18], "save": [3, 18], "disk": 3, "dict": [3, 16, 17], "empti": [3, 17, 19, 20, 21, 22], "dictionari": 3, "other": [3, 16, 17, 18], "mai": [3, 18], "influenc": 3, "overal": 3, "metric": [4, 14, 16, 17, 20], "shannon": [4, 5, 16, 17, 20], "return_comp": [4, 17, 20], "heterogen": [4, 6, 17], "either": [4, 6, 7, 12, 18, 20], "relat": [4, 23], "comput": [4, 9, 12, 13, 18], "defin": [4, 7, 14, 17], "group": [4, 17], "e": [4, 10, 11], "g": [4, 10, 11], "comprehens": 4, "result": [4, 10, 11, 17, 18, 19, 20, 21, 22, 23], "detail": [4, 14, 16, 18], "along": [4, 9, 18], "seri": [4, 6, 17, 20, 21], "cell": [4, 6, 10, 11, 14, 18, 23], "composit": [4, 12, 17, 23], "count": [5, 12, 18], "entropi": 5, "numpi": [5, 6, 8, 9, 12, 13, 17, 18, 19, 20, 21, 22], "ndarrai": [5, 6, 8, 9, 11, 12, 13], "arrai": [5, 9, 12, 13, 18, 20], "frequenc": [5, 10, 23], "distinct": [5, 18], "event": 5, "dataset": [5, 12, 18], "heterogeneity_indic": [6, 17], "tissue_onli": [6, 8, 9, 17], "return_fig": [6, 17], "visual": [6, 8, 9, 16, 17, 18], "heatmap": [6, 23], "origin": 6, "its": 6, "onli": [6, 8, 9, 14, 17, 18], "ar": [6, 7, 10, 17, 18, 19, 20, 22], "includ": [6, 8, 9, 13, 18], "matplotlib": [6, 17, 18], "none": [6, 10, 17, 18], "grid": [6, 8, 9, 17], "both": [6, 18, 19, 20, 21, 22], "scaling_factor": [7, 17, 21, 22], "them": [7, 17], "accord": 7, "given": [7, 13], "segreg": 7, "subset": [7, 16, 17, 18, 21, 22], "int": [7, 9, 10, 13, 17], "dimens": 7, "size": [7, 16, 17, 18, 19, 21, 22], "deriv": 7, "plot_weight": [8, 9, 17], "perform": [8, 18, 23], "autocorrel": [8, 9], "2d": [8, 9, 13, 17], "method": [8, 9, 13, 17, 18], "gearyc": [8, 9], "getisordg": [8, 9], "exclud": 8, "non": [8, 21, 22], "area": [8, 21], "weight": [8, 9], "matrix": [8, 9, 13, 17, 18], "help": 8, "understand": [8, 9, 14], "relationship": [8, 9], "degre": 8, "test": [8, 10, 17, 23, 24], "seed": [9, 17, 21, 22], "42": [9, 17, 18, 21, 22], "return_stat": [9, 17], "local": [9, 14, 23], "lisa": [9, 17], "base": [9, 12, 16, 17, 23], "cutoff": 9, "ensur": 9, "reproduc": [9, 21, 22], "aid": 9, "boolean": 9, "locat": [9, 13, 18], "high": [9, 22], "surround": 9, "low": [9, 18], "spot": [10, 17], "hot": [10, 23], "combin": [10, 17], "2": [10, 13, 16, 17, 18, 19, 20, 21, 22], "top": [10, 17, 18], "15": [10, 13, 17, 18], "selected_comb": [10, 17], "co": [10, 23], "occurr": [10, 23], "across": [10, 12, 14, 18], "cold": [10, 17], "number": [10, 13, 17, 18, 19], "consid": [10, 17], "appli": [10, 18], "normal": [10, 18], "select": [10, 17, 18], "transpos": 10, "show": [10, 17, 18], "sort": [10, 17, 18], "exp_df": 11, "spatial_knn_indic": [11, 18], "averag": [11, 23], "express": [11, 14, 23], "over": 11, "neighbor": [11, 12, 13, 18], "point": [11, 13, 17, 18, 19, 20, 21, 22], "row": [11, 12, 13, 17, 18], "attribut": 11, "gene": [11, 14, 18], "np": [11, 17, 18, 19, 20, 21, 22], "k": [11, 12, 13, 17, 18], "nearest": [11, 12, 13, 18], "structur": 11, "knn_indic": [12, 18], "label": [12, 16, 17, 18, 21], "all_label": [12, 18], "percentag": 12, "form": 12, "nn": [12, 13], "shape": [12, 13, 16, 17, 18, 19, 20, 21, 22], "n_sampl": [12, 13], "n_neighbor": [12, 13, 18], "appear": 12, "particular": 12, "neighborhood": [12, 14, 23], "all": [12, 18, 19, 20, 21, 22, 23], "uniqu": [12, 16, 17, 18], "refer": 12, "total": [12, 18, 22], "raw": 12, "len": [12, 17, 18, 20, 21, 22], "kd_tree": [13, 18], "space": 13, "ball_tre": 13, "brute": 13, "order": [13, 17, 18], "novel": 14, "pipelin": [14, 18], "bring": 14, "principl": 14, "togeth": 14, "integr": [14, 23], "therebi": 14, "enabl": 14, "deeper": 14, "more": [14, 18, 21, 22], "shift": 14, "remodel": 14, "draw": 14, "inspir": 14, "studi": 14, "adapt": 14, "tradition": 14, "gaug": 14, "biodivers": 14, "omic": [14, 18], "creat": [14, 16, 17, 20, 21, 22], "tool": 14, "systemat": 14, "quantif": 14, "cellular": [14, 23], "we": [14, 18], "introduc": 14, "multi": [14, 17], "alongsid": [14, 16], "captur": [14, 18], "overarch": 14, "also": [14, 18], "pattern": [14, 17, 18, 19, 20, 21, 22], "depend": 14, "furthermor": 14, "emploi": 14, "approach": [14, 16], "analys": 14, "silico": [14, 18], "amalgam": 14, "cross": [14, 18], "modal": [14, 18], "enrich": 14, "context": [14, 20], "observ": [14, 18], "With": 14, "layer": 14, "brought": 14, "bear": 14, "facilit": 14, "extend": [14, 17], "view": 14, "interact": 14, "microenviron": 14, "differenti": 14, "ligand": 14, "receptor": 14, "assembli": 14, "enhanc": 14, "mechanist": 14, "brows": 14, "tutori": 14, "project": 14, "activ": [14, 18], "develop": 14, "academ": 14, "softwar": 14, "agreement": 14, "pleas": [14, 17, 18, 19, 20, 21, 22], "accordingli": 14, "run": [15, 16, 18, 19, 20, 21, 22], "pip": 15, "py": [15, 17, 18, 19, 20, 21, 22], "To": [16, 17, 18, 21], "you": [16, 18], "util": [16, 18, 22], "reticul": 16, "provid": 16, "bridg": 16, "between": [16, 18, 19, 20, 21, 22], "python": 16, "here": [16, 18], "how": [16, 18], "get": [16, 18], "start": 16, "instal": [16, 18], "modul": 16, "need": [16, 18], "For": [16, 18, 20, 21, 22], "exampl": [16, 18], "ecolog": 16, "eco": [16, 17, 19, 20], "ecospati": [16, 19, 20, 21, 22, 23], "now": [16, 18], "model": [16, 18], "directli": [16, 18], "your": 16, "environ": 16, "allow": 16, "har": 16, "power": 16, "capabl": 16, "framework": 16, "see": [16, 18], "below": [16, 18], "dplyr": 16, "ggplot2": 16, "ggbeeswarm": 16, "adata": [16, 17, 18, 20, 21, 22], "read_h5ad": [16, 17], "user": [16, 17, 18, 19, 20, 21, 22], "emri": [16, 17, 18], "dropbox": [16, 17], "spatial_augment": [16, 17], "codex_mouse_spleen": [16, 17], "h5ad": [16, 17], "obsm": [16, 17, 20, 21, 22], "1000": [16, 17, 19, 21, 22], "ob": [16, 17, 20, 21, 22], "vector": 16, "c": [16, 17], "1": [16, 17, 18, 19, 20, 21, 22], "4": [16, 17, 18, 19, 20, 21, 22], "8": [16, 17, 18, 19, 20, 21, 22], "16": [16, 17, 18, 19, 20, 21, 22], "32": [16, 17, 18], "64": [16, 17], "multiscale_divers": 16, "cell_typ": [16, 17], "random_se": [16, 17, 22], "null": 16, "min_point": [16, 17, 22], "mdi_result": [16, 17], "frame": 16, "t": [16, 17, 21], "colnam": 16, "add": [16, 17, 18], "sample_id": [16, 17], "na": 16, "rownam": 16, "assign": [16, 18], "mutat": 16, "case_when": 16, "grepl": 16, "balbc": [16, 17], "mrl": [16, 17], "two": [16, 18, 21, 22], "mdi_balbc": 16, "filter": [16, 17, 18], "pull": 16, "mdi_mrl": 16, "welch": 16, "t_test_result": 16, "var": [16, 17, 18, 21], "equal": 16, "boxplot": [16, 17], "swarmplot": [16, 17], "overlai": 16, "ggplot": 16, "ae": 16, "x": [16, 17, 18, 19, 21, 22], "y": [16, 17, 18, 19, 21, 22], "fill": [16, 17], "geom_boxplot": 16, "outlier": 16, "without": 16, "geom_beeswarm": 16, "color": [16, 18, 23], "alpha": [16, 17], "6": [16, 17, 18, 20], "swarm": 16, "lab": 16, "titl": [16, 17, 18], "theme_minim": 16, "annot": [16, 17], "text": [16, 17, 18], "5": [16, 17, 18, 19, 20, 21, 22], "max": [16, 17, 18, 21, 22], "paste0": 16, "round": 16, "3": [16, 17, 18, 19, 20, 21, 22], "black": [16, 17], "print": [16, 17, 18, 20], "seaborn": [17, 18], "sn": [17, 18], "scipi": [17, 18], "stat": 17, "pyplot": [17, 18], "plt": [17, 18], "mcolor": 17, "figaspect": 17, "o": [17, 18, 19, 20, 21, 22], "sy": [17, 18, 19, 20, 21, 22], "path": [17, 18, 19, 20, 21, 22], "append": [17, 18, 19, 20, 21, 22], "omp": [17, 18, 19, 20, 21, 22], "info": [17, 18, 19, 20, 21, 22], "270": 17, "omp_set_nest": [17, 18, 19, 20, 21, 22], "routin": [17, 18, 19, 20, 21, 22], "deprec": [17, 18, 19, 20, 21, 22], "omp_set_max_active_level": [17, 18, 19, 20, 21, 22], "instead": [17, 18, 19, 20, 21, 22], "opt": [17, 18, 19, 20, 21, 22], "miniconda3": [17, 18, 19, 20, 21, 22], "env": [17, 18, 19, 20, 21, 22], "mesa_test": 17, "lib": [17, 18, 19, 20, 21, 22], "python3": [17, 18, 19, 20, 21, 22], "10": [17, 18, 19, 20, 21, 22], "site": [17, 18, 19, 20, 21, 22], "packag": [17, 18, 19, 20, 21, 22, 23], "spaghetti": [17, 18, 19, 20, 21, 22], "network": [17, 18, 19, 20, 21, 22], "futurewarn": [17, 18, 19, 20, 21, 22], "next": [17, 18, 19, 20, 21, 22], "major": [17, 18, 19, 20, 21, 22], "releas": [17, 18, 19, 20, 21, 22], "pysal": [17, 18, 19, 20, 21, 22], "drop": [17, 18, 19, 20, 21, 22], "support": [17, 18, 19, 20, 21, 22], "libpys": [17, 18, 19, 20, 21, 22], "cg": [17, 18, 19, 20, 21, 22], "geometri": [17, 18, 19, 20, 21, 22], "chang": [17, 18, 19, 20, 21, 22], "first": [17, 18, 19, 20, 21, 22], "step": [17, 19, 20, 21, 22, 23], "refactor": [17, 18, 19, 20, 21, 22], "expect": [17, 18, 19, 20, 21, 22], "dramat": [17, 18, 19, 20, 21, 22], "reduc": [17, 18, 19, 20, 21, 22], "runtim": [17, 18, 19, 20, 21, 22], "instanti": [17, 18, 19, 20, 21, 22], "oper": [17, 18, 19, 20, 21, 22], "current": [17, 18, 19, 20, 21, 22], "requir": [17, 18, 19, 20, 21, 22], "input": [17, 18, 19, 20, 21, 22], "prepar": [17, 19, 20, 21, 22, 23], "simpli": [17, 18, 19, 20, 21, 22], "convert": [17, 18, 19, 20, 21, 22], "warn": [17, 18, 19, 20, 21, 22], "dep_msg": [17, 18, 19, 20, 21, 22], "stacklevel": [17, 18, 19, 20, 21, 22], "rcparam": [17, 18], "font": [17, 18], "famili": [17, 18], "arial": [17, 18], "svg": [17, 18], "fonttyp": [17, 18], "keep": [17, 18], "unit": [17, 24], "micron": 17, "colormap": 17, "cell_nam": 17, "tolist": [17, 18], "tab10": 17, "tab20b": 17, "tab20c": 17, "extract": [17, 18, 21, 22], "19": [17, 18], "colors_from_tab20b": 17, "rang": [17, 18], "20": [17, 18, 22], "11": [17, 18, 19, 20, 21, 22], "colors_from_tab20c": 17, "12": [17, 18], "custom_palett": 17, "colors_hex": 17, "rgb2hex": 17, "color_dict": 17, "zip": [17, 18], "cd4": [17, 18], "cd8": [17, 18], "31a354": 17, "cd106": 17, "cd16": [17, 18], "ly6c": 17, "cd31": [17, 18], "e7cb94": 17, "f4": 17, "80": 17, "mph": 17, "fdc": 17, "mhcii": 17, "637939": 17, "stroma": 17, "9": [17, 18, 19, 20], "noid": 17, "8c6d31": 17, "7": [17, 18], "fig": 17, "ax": [17, 18], "subplot": 17, "item": 17, "scatter": 17, "marker": [17, 18], "edgecolor": 17, "linewidth": 17, "legend": [17, 18], "loc": [17, 18], "center": [17, 18], "ncol": 17, "fontsiz": [17, 18], "small": 17, "axi": [17, 18, 20, 21, 22], "off": 17, "quardrat": 17, "patches_coordin": 17, "generate_patch": [17, 24], "sequenc": 17, "df_result": 17, "calculate_mdi": [17, 24], "000": [17, 19, 20], "per": [17, 19, 20], "cent": [17, 19, 20], "ha": [17, 18, 19], "zero": [17, 19, 21, 22], "diveristi": [17, 19], "4656779602794114": 17, "292377010141359": 17, "0901648127096593": 17, "8661607204492103": 17, "631288636532884": 17, "332991483128386": 17, "098": 17, "27": [17, 18], "8713334691757577": 17, "f": 17, "3f": 17, "466": 17, "cacul": 17, "quadrat": 17, "patch_indic": 17, "patches_comp": [17, 20], "calculate_diversity_index": [17, 24], "heatmap_fig": 17, "diversity_heatmap": 17, "p_sim": 17, "global_spatial_stat": 17, "379": 17, "001": 17, "13": [17, 18, 19, 20, 21, 22], "_": 17, "local_spatial_stat": 17, "signif_heatmap": 17, "discret": 17, "14": [17, 18, 22], "ldi": 17, "find": [17, 23], "visualis": 17, "combined_spot": 17, "seismic": 17, "cm": 17, "white": 17, "999": 17, "cmap": [17, 18], "linearsegmentedcolormap": 17, "from_list": 17, "custom_map": 17, "spatial_valu": [17, 22], "min_x": 17, "min_i": 17, "min": [17, 21, 22], "max_x": 17, "max_i": 17, "width": 17, "height": 17, "w": 17, "h": 17, "spot_fig": 17, "figsiz": [17, 18], "add_ax": 17, "diversity_index": 17, "enumer": [17, 22], "flatten": 17, "x0": [17, 20, 21, 22], "y0": [17, 20, 21, 22], "x1": [17, 20, 21, 22], "y1": [17, 20, 21, 22], "imshow": 17, "interpol": 17, "vmin": 17, "vmax": 17, "1768": 17, "140": 17, "1704": 17, "784": 17, "lt": [17, 18, 19, 20, 21, 22], "imag": 17, "axesimag": 17, "0x12581f790": 17, "gt": [17, 18, 19, 20, 21, 22], "investig": 17, "island": 17, "proximity_i": 17, "calculate_dpi": 17, "331": 17, "61": 17, "183": [17, 20], "256": 17, "17": 17, "similar": [17, 18], "distanc": 17, "pdist": 17, "squareform": 17, "labelled_hot": 17, "num_hot_island": 17, "_util": [17, 22], "_label_island": 17, "rook": 17, "labelled_cold": 17, "num_cold_island": 17, "aggreg": [17, 18], "filtered_patches_coordin": 17, "is_hotspot": 17, "filtered_patches_comp": 17, "island_comp": 17, "aggregate_spot_composit": 17, "els": [17, 18], "is_coldspot": 17, "head": [17, 18], "b": [17, 18, 20], "b220": 17, "dn": 17, "hi": 17, "vascular": 17, "cdc": 17, "ertr7": 17, "erythroblast": 17, "plasma": 17, "island_1": 17, "18": [17, 18], "23": [17, 18], "island_2": 17, "nan": 17, "island_3": 17, "29": [17, 18], "49": 17, "island_4": 17, "28": [17, 18], "46": [17, 18], "island_5": 17, "red": 17, "blue": [17, 18], "ndimag": 17, "center_of_mass": 17, "grei": 17, "single_color_map": 17, "centroid": [17, 18], "posit": [17, 21], "fontweight": 17, "semibold": 17, "va": 17, "bottom": 17, "xlabel": [17, 18], "ylabel": [17, 18], "75": 17, "1399999999999": 17, "0x124d323e0": 17, "21": [17, 18], "col": 17, "kind": 17, "barh": 17, "stack": [17, 18], "xtick": 17, "rotat": 17, "ytick": 17, "spine": 17, "set_vis": 17, "right": 17, "invert_yaxi": 17, "tight_layout": 17, "22": [17, 18], "div": 17, "sum": 17, "island_comp_fil": 17, "fillna": 17, "brai": 17, "curti": 17, "braycurti": 17, "condens": 17, "squar": 17, "distance_matrix": 17, "mask": [17, 18], "upper": [17, 18], "triangl": 17, "triu": 17, "ones_lik": 17, "dtype": [17, 18, 19], "axis_label": 17, "arang": 17, "rocket": 17, "xticklabel": [17, 18], "yticklabel": [17, 18], "cbar_kw": 17, "shrink": 17, "dissimilar": 17, "make": [17, 18], "when": [17, 18, 21, 22], "8224049147168166": 17, "8742375282078143": 17, "8116755585127406": 17, "126137234736102": 17, "2585089241112524": 17, "3443099513229604": 17, "128433889698631": 17, "3719588637812334": 17, "8096339612313344": 17, "8382163972175585": 17, "741064715284067": 17, "0831593675761644": 17, "0598843042677837": 17, "0862452321757026": 17, "9923502002689952": 17, "200400887232563": 17, "6784053488305974": 17, "6853948865791275": 17, "6305199375873096": 17, "9864270563061894": 17, "8110161541535192": 17, "957160443128632": 17, "7304462437482897": 17, "0674673256522307": 17, "4799987919407114": 17, "562": 17, "5268685163240683": 17, "463874240684387": 17, "781459883250105": 17, "5436517302775545": 17, "74441429620238": 17, "491933508895646": 17, "8482716801311714": 17, "172": 17, "286806849622593": 17, "734": 17, "305147780044155": 17, "906": 17, "2551143500517985": 17, "5551198016811867": 17, "3339712388594913": 17, "5482756959354242": 17, "2869583672535363": 17, "6694817985568324": 17, "855": 17, "0660450865998814": 17, "395": 17, "077747085040528": 17, "250": 17, "0045285007782714": 17, "293": 17, "269587989274803": 17, "038872313385172": 17, "2839611402939903": 17, "0264183988555406": 17, "4175820356238615": 17, "222": 17, "7211111421043181": 17, "542": 17, "45": [17, 18], "7323775368753875": 17, "812": 17, "83": 17, "6591825505403395": 17, "708": 17, "51": 17, "7929988800461276": 17, "5852570804754544": 17, "220": 17, "30": [17, 18], "8367502236578277": 17, "69": 17, "6188286349155905": 17, "9853016901779386": 17, "slope": [17, 19], "822405": 17, "809634": 17, "678405": 17, "479999": 17, "286807": 17, "066045": 17, "721111": 17, "185095": 17, "874238": 17, "838216": 17, "685395": 17, "526869": 17, "305148": 17, "077747": 17, "732378": 17, "190242": 17, "811676": 17, "741065": 17, "63052": 17, "463874": 17, "255114": 17, "004529": 17, "659183": 17, "189498": 17, "126137": 17, "083159": 17, "986427": 17, "78146": 17, "55512": 17, "269588": 17, "792999": 17, "216352": 17, "258509": 17, "059884": 17, "811016": 17, "543652": 17, "333971": 17, "038872": 17, "585257": 17, "269244": 17, "34431": 17, "086245": 17, "95716": 17, "744414": 17, "548276": 17, "283961": 17, "83675": 17, "233433": 17, "128434": 17, "99235": 17, "730446": 17, "491934": 17, "286958": 17, "026418": 17, "618829": 17, "246577": 17, "465678": 17, "292377": 17, "090165": 17, "866161": 17, "631289": 17, "332991": 17, "871333": 17, "255739": 17, "371959": 17, "200401": 17, "067467": 17, "848272": 17, "669482": 17, "417582": 17, "985302": 17, "218700": 17, "gdi_result": 17, "calculate_gdi": 17, "639407": 17, "689433": 17, "696760": 17, "489871": 17, "465093": 17, "424368": 17, "463416": 17, "379494": 17, "433336": 17, "dpi_result": 17, "687": 17, "48": 17, "851": 17, "47": 17, "712": 17, "480": 17, "53": 17, "443": 17, "43": 17, "326": 17, "499": 17, "348": 17, "71": 17, "404": 17, "254256": 17, "506": 17, "251921": 17, "425": 17, "808947": 17, "151840": 17, "224": 17, "575542": 17, "135": [17, 19], "896041": 17, "262": 17, "844537": 17, "255600": 17, "208": 17, "151759": 17, "global_cellfreq_df": 17, "global_co_occurrence_df": 17, "spot_cellfreq": 17, "whole": 17, "global_co_occurrence_subcol": 17, "mean": [17, 18], "05": 17, "mous": 17, "melt": 17, "easier": 17, "global_cellfreq_df_melt": 17, "reset_index": [17, 21, 22], "id_var": 17, "003969": 17, "003772": 17, "005446": 17, "014466": 17, "019893": 17, "238": 17, "003016": 17, "239": 17, "013661": 17, "240": 17, "003686": 17, "241": 17, "016240": 17, "242": 17, "006100": 17, "243": 17, "selected_cell_typ": 17, "selected_p_valu": 17, "ct": 17, "group1": 17, "group2": 17, "t_stat": 17, "ttest_ind": 17, "equal_var": 17, "pvals_correct": 17, "false_discovery_control": 17, "bh": 17, "after": [17, 18], "correct": [17, 21, 22], "hue": [17, 18], "mute": 17, "boxprop": 17, "dodg": 17, "dark": 17, "auto": 17, "handl": 17, "get_legend_handles_label": 17, "handletextpad": 17, "columnspac": 17, "bbox_to_anchor": 17, "frameon": 17, "90": 17, "p_vals_corrected_dict": 17, "yrang": 17, "get_ylim": 17, "flush": 17, "axvlin": 17, "55": 17, "linestyl": 17, "set_ylabel": 17, "set_xlabel": 17, "006408963135728074": 17, "08363460243637065": 17, "10246220899780342": 17, "04098951744156447": 17, "48760707221130684": 17, "00014746290448731814": 17, "029644306916028648": 17, "cd11c": 17, "04433015687789797": 17, "cd3": [17, 18], "0039461017917897965": 17, "744873603519344": 17, "23629828012676266": 17, "002101995902806824": 17, "27737999550550363": 17, "00013225110887609995": 17, "13322938432638706": 17, "8144572874311375": 17, "5151830491689221": 17, "010569967873872599": 17, "05479798379321029": 17, "nk": 17, "6906209729704317": 17, "capsul": 17, "03375417362245463": 17, "006927955270797655": 17, "granulocyt": 17, "550715896090467e": 17, "06": 17, "margin": 17, "zone": 17, "0024009677611480013": 17, "megakaryocyt": 17, "00616336220396191": 17, "0859271670427784": 17, "22183894046691652": 17, "021": 17, "136": 17, "154": 17, "085": 17, "572": 17, "073": 17, "018": 17, "774": 17, "304": 17, "013": 17, "340": 17, "189": 17, "814": 17, "580": 17, "029": 17, "099": 17, "746": 17, "076": 17, "299": 17, "spot_cellfreq_df": 17, "spot_co_occurrence_df": 17, "spot_co_occurrence_subcol": 17, "spot_cellfreq_df_melt": 17, "var_nam": [17, 18], "celltyp": 17, "value_nam": 17, "befor": [17, 18, 19], "df_melt": 17, "4f": 17, "df_filter": 17, "isin": 17, "spot_pvals_correct": 17, "map": 17, "lambda": [17, 18], "j": 17, "close": 17, "0000": 17, "0139": 17, "0097": 17, "0062": 17, "9028": 17, "0112": 17, "0295": 17, "0342": 17, "0460": 17, "0861": 17, "1443": 17, "0067": 17, "4478": 17, "0015": 17, "1899": 17, "2234": 17, "2324": 17, "0012": 17, "6537": 17, "2228": 17, "0739": 17, "0149": 17, "0010": 17, "0311": 17, "0195": 17, "3912": 17, "4404": 17, "040": 17, "037": 17, "030": 17, "903": 17, "038": 17, "065": 17, "066": 17, "083": 17, "137": 17, "216": 17, "484": 17, "010": 17, "285": 17, "679": 17, "125": 17, "048": 17, "459": 17, "union_col": 17, "have": [17, 18, 21, 22], "same": [17, 18, 22], "reindex": 17, "new_column": 17, "isinst": 17, "check": [17, 18, 19, 21, 22], "multiindex": 17, "join": [17, 18], "name": [17, 18], "strip": 17, "global_co_occurrence_df_singl": 17, "copi": [17, 18, 20, 21, 22], "global_co_occurrence_melt": 17, "amp": 17, "016479": 17, "025588": 17, "015360": 17, "059257": 17, "054832": 17, "976": 17, "021638": 17, "977": 17, "019085": 17, "978": 17, "021287": 17, "979": 17, "027615": 17, "980": 17, "045166": 17, "981": 17, "grai": 17, "034": 17, "161": 17, "008": 17, "053": 17, "236": 17, "006": 17, "686": 17, "003": 17, "004": 17, "033": 17, "031": 17, "960": 17, "232": 17, "041": 17, "022": 17, "002": 17, "114": 17, "024": 17, "579": 17, "660": 17, "005": 17, "479": 17, "124": 17, "035": 17, "231": 17, "007": 17, "009": 17, "100": [17, 18, 20], "077": 17, "142": [17, 21], "718": 17, "097": 17, "168": 17, "011": 17, "826": 17, "184": 17, "582": 17, "049": 17, "017": 17, "344": 17, "501": 17, "211": 17, "036": 17, "120": 17, "057": 17, "549": 17, "106": [17, 18, 19, 20, 21, 22], "056": 17, "334": 17, "016": 17, "148": 17, "568": 17, "519": 17, "555": 17, "578": 17, "116": 17, "581": 17, "folder": [17, 21], "7g": [17, 21], "phdhh_ld3dlbnrst0t60bwzr0000gn": [17, 21], "ipykernel_23301": 17, "3825649457": 17, "34": [17, 18, 20], "automat": 17, "grayscal": 17, "v0": 17, "39": [17, 18], "definit": 17, "062": 17, "212": 17, "019": 17, "286": 17, "706": 17, "014": 17, "061": 17, "059": 17, "068": 17, "045": 17, "165": 17, "063": 17, "610": 17, "685": 17, "015": 17, "556": 17, "173": 17, "149": 17, "118": 17, "290": 17, "193": 17, "731": 17, "146": 17, "218": 17, "025": 17, "834": 17, "079": 17, "012": 17, "204": 17, "403": 17, "575": 17, "265": 17, "169": 17, "088": 17, "156": 17, "396": 17, "043": 17, "263": 17, "199": 17, "589": 17, "166": 17, "spot_co_occurrence_df_singl": 17, "spot_co_occurrence_melt": 17, "040757": 17, "058754": 17, "042135": 17, "162500": 17, "128668": 17, "056433": 17, "052147": 17, "052104": 17, "057402": 17, "103448": 17, "hot_pvals_correct": 17, "highlighted_comb": 17, "split": [17, 18], "252": 17, "093": 17, "390": 17, "408": 17, "027": 17, "314": 17, "632": 17, "721": 17, "329": 17, "966": 17, "060": 17, "292": 17, "091": 17, "596": 17, "260": 17, "112": 17, "393": [17, 22], "954": 17, "677": 17, "448": 17, "153": 17, "899": 17, "259": 17, "829": 17, "350": 17, "475": 17, "234": 17, "1275659436": 17, "316": 17, "446": 17, "458": 17, "047": 17, "372": 17, "069": 17, "682": 17, "748": 17, "039": 17, "386": 17, "351": 17, "028": 17, "210": 17, "649": 17, "318": 17, "160": 17, "050": 17, "283": 17, "963": 17, "064": 17, "026": 17, "916": 17, "020": 17, "852": 17, "406": 17, "523": 17, "167": 17, "303": 17, "719": 17, "circoplot_df1": 17, "sort_index": 17, "groupbi": [17, 18], "set_index": 17, "073364": 17, "154887": 17, "256508": 17, "117092": 17, "026082": 17, "024203": 17, "609478": 17, "133404": 17, "033559": 17, "435705": 17, "037708": 17, "020787": 17, "11371": 17, "393021": 17, "120370": 17, "046403": 17, "097886": 17, "034235": 17, "101013": 17, "041810": 17, "190871": 17, "059676": 17, "186811": 17, "060700": 17, "051504": 17, "036226": 17, "382356": 17, "140771": 17, "115103": 17, "272822": 17, "102183": 17, "026166": 17, "04952": 17, "251273": 17, "133979": 17, "024188": 17, "089268": 17, "051191": 17, "250753": 17, "047435": 17, "109": 17, "426889": 17, "001323": 17, "199109": 17, "009298": 17, "001590": 17, "002537": 17, "000680": 17, "086876": 17, "018936": 17, "008218": 17, "002100": 17, "044063": 17, "009395": 17, "015804": 17, "001275": 17, "008339": 17, "003399": 17, "409448": 17, "001330": 17, "186915": 17, "008422": 17, "000598": 17, "002685": 17, "001306": 17, "088276": 17, "003174": 17, "015612": 17, "008544": 17, "003699": 17, "054574": 17, "013061": 17, "011742": 17, "000769": 17, "006286": 17, "400763": 17, "001408": 17, "223815": 17, "008694": 17, "001988": 17, "001457": 17, "000617": 17, "102824": 17, "001815": 17, "007768": 17, "006755": 17, "003940": 17, "051276": 17, "008200": 17, "016685": 17, "000667": 17, "007830": 17, "004224": 17, "378136": 17, "005246": 17, "075272": 17, "024428": 17, "002000": 17, "017725": 17, "002424": 17, "033211": 17, "001285": 17, "006200": 17, "011565": 17, "000927": 17, "214980": 17, "045479": 17, "008704": 17, "003683": 17, "012943": 17, "002159": 17, "218244": 17, "003634": 17, "135901": 17, "038220": 17, "003002": 17, "026945": 17, "001120": 17, "073725": 17, "000862": 17, "001135": 17, "008862": 17, "000187": 17, "287631": 17, "039742": 17, "003217": 17, "005458": 17, "007354": 17, "056364": 17, "255290": 17, "005701": 17, "201898": 17, "016811": 17, "000957": 17, "017219": 17, "001569": 17, "074642": 17, "001020": 17, "000804": 17, "005217": 17, "000217": 17, "149641": 17, "034974": 17, "002334": 17, "002755": 17, "009247": 17, "018444": 17, "130895": 17, "005161": 17, "224515": 17, "025679": 17, "003899": 17, "019769": 17, "001162": 17, "157824": 17, "000850": 17, "000175": 17, "005423": 17, "000150": 17, "259491": 17, "041686": 17, "000600": 17, "002612": 17, "006698": 17, "176714": 17, "179097": 17, "004766": 17, "177823": 17, "021902": 17, "001879": 17, "016291": 17, "011235": 17, "071379": 17, "000908": 17, "001715": 17, "007401": 17, "000353": 17, "139795": 17, "038192": 17, "003808": 17, "002396": 17, "012697": 17, "221316": 17, "027663": 17, "001739": 17, "207226": 17, "030473": 17, "001059": 17, "015451": 17, "005054": 17, "117974": 17, "000416": 17, "000101": 17, "005684": 17, "000466": 17, "084539": 17, "032880": 17, "000252": 17, "001979": 17, "010952": 17, "circoplot_df2": 17, "004396": 17, "412367": 17, "001354": 17, "203280": 17, "008805": 17, "001392": 17, "002227": 17, "000868": 17, "092659": 17, "002509": 17, "026396": 17, "087874": 17, "014105": 17, "007839": 17, "003246": 17, "049971": 17, "010219": 17, "014744": 17, "000903": 17, "004050": 17, "084533": 17, "198221": 17, "004375": 17, "170439": 17, "026252": 17, "002132": 17, "018900": 17, "003761": 17, "088126": 17, "000890": 17, "032504": 17, "024637": 17, "001688": 17, "007359": 17, "000383": 17, "189346": 17, "038826": 17, "003152": 17, "003147": 17, "007477": 17, "26": [17, 18], "patient_group": 17, "create_circos_plot": 17, "cell_type_colors_hex": 17, "cell_abund": 17, "edge_weights_scal": 17, "highlighted_edg": 17, "node_weights_scal": 17, "5000": [17, 18, 19, 22], "figure_s": 17, "save_path": 17, "io": 18, "mmread": 18, "scanpi": 18, "sc": 18, "sklearn": 18, "kmean": 18, "tqdm": 18, "preprocess": 18, "minmaxscal": 18, "geopanda": [18, 19, 20, 21, 22], "_compat": [18, 19, 20, 21, 22], "userwarn": [18, 19, 20, 21, 22], "geo": [18, 19, 20, 21, 22], "version": [18, 19, 20, 21, 22], "capi": [18, 19, 20, 21, 22], "incompat": [18, 19, 20, 21, 22], "pygeo": [18, 19, 20, 21, 22], "wa": [18, 19, 20, 21, 22], "compil": [18, 19, 20, 21, 22], "convers": [18, 19, 20, 21, 22], "slow": [18, 19, 20, 21, 22], "276": [18, 19, 20, 21, 22], "41": [18, 19, 20, 21, 22], "begin": 18, "read": [18, 23], "codex": 18, "scrnaseq": 18, "data_dir": 18, "download": 18, "tonsil": 18, "read_csv": 18, "tonsil_codex": 18, "csv": 18, "let": 18, "scatterplot": 18, "centroid_x": 18, "centroid_i": 18, "term": 18, "meta": 18, "take": 18, "featur": 18, "protein_featur": 18, "cd38": 18, "cd19": 18, "vimentin": 18, "cd22": 18, "ki67": 18, "cd90": 18, "cd123": 18, "cd15": 18, "cd152": 18, "cd21": 18, "cytokeratin": 18, "cd2": 18, "cd66": 18, "collagen": 18, "cd81": 18, "hla": 18, "dr": 18, "cd57": 18, "cd7": 18, "cd278": 18, "podoplanin": 18, "cd45ra": 18, "cd34": 18, "cd54": 18, "cd9": 18, "igm": 18, "cd117": 18, "cd56": 18, "cd279": 18, "cd45": 18, "cd49f": 18, "cd5": 18, "cd63": 18, "cd11b": 18, "cd1c": 18, "cd40": 18, "cd274": 18, "cd27": 18, "cd104": 18, "cd273": 18, "fapalpha": 18, "ecadherin": 18, "protein_adata": 18, "to_numpi": 18, "float32": 18, "Then": 18, "format": 18, "too": [18, 22], "rna": 18, "tonsil_rna_count": 18, "txt": 18, "spars": 18, "10k": 18, "rna_nam": 18, "tonsil_rna_nam": 18, "rna_adata": 18, "tocsr": 18, "rna_adata_raw": 18, "most": 18, "time": 18, "antibodi": 18, "construct": 18, "straight": 18, "forward": 18, "wai": 18, "file": 18, "seen": 18, "cite": 18, "seq": 18, "etc": 18, "protein_gene_convers": 18, "cd80": 18, "cd86": 18, "pdcd1lg2": 18, "cd275": 18, "icoslg": 18, "But": 18, "cours": 18, "doe": 18, "new": [18, 22], "assai": 18, "certain": 18, "found": [18, 20], "miss": [18, 20], "customli": 18, "rna_protein_correspond": 18, "curr_protein_nam": 18, "curr_rna_nam": 18, "iloc": [18, 21], "continu": 18, "ignor": [18, 19, 20, 21, 22], "some": 18, "eg": 18, "isoform": 18, "one": [18, 23], "multipl": 18, "r": [18, 23], "rna_shar": 18, "protein_shar": 18, "match": 18, "One": 18, "encount": 18, "variabl": 18, "fine": 18, "becaus": 18, "encod": 18, "vice": 18, "versa": 18, "sure": 18, "static": 18, "toarrai": 18, "std": 18, "12977": 18, "178919": 18, "standard": 18, "skip": 18, "alreadi": 18, "et": 18, "pp": 18, "normalize_tot": 18, "log1p": 18, "again": 18, "avail": 18, "measur": 18, "just": 18, "share": [18, 20], "ones": 18, "rna_act": 18, "protein_act": 18, "iter": 18, "highly_variable_gen": 18, "n_top_gen": 18, "retain": 18, "highli": 18, "highly_vari": 18, "1e": 18, "sinc": [18, 21, 22], "In": [18, 21], "illustr": 18, "maxfus": 18, "proce": 18, "ll": 18, "follow": 18, "outlin": 18, "while": 18, "implement": 18, "document": 18, "out": [18, 22], "http": 18, "readthedoc": 18, "en": 18, "latest": 18, "html": 18, "load": [18, 23], "ahead": 18, "mf": 18, "call": [18, 19], "constructor": 18, "fusor": 18, "main": [18, 19, 20, 21, 22], "shared_arr1": 18, "shared_arr2": 18, "active_arr1": 18, "active_arr2": 18, "labels1": 18, "labels2": 18, "complex": 18, "split_into_batch": 18, "fit": 18, "batch": 18, "max_outward_s": 18, "8000": 18, "matching_ratio": 18, "metacell_s": 18, "verbos": 18, "second": [18, 22], "35783": 18, "35787": 18, "appropri": 18, "graph": 18, "singular": 18, "mani": 18, "princip": 18, "compon": 18, "pc": 18, "do": 18, "avtive_arr1": 18, "plot_singular_valu": 18, "target": 18, "n_compon": 18, "explicitli": 18, "600x600": 18, "v": 18, "avtive_arr2": 18, "inspect": 18, "elbow": 18, "choos": 18, "40": 18, "construct_graph": 18, "n_neighbors1": 18, "n_neighbors2": 18, "svd_components1": 18, "svd_components2": 18, "resolution1": 18, "resolution2": 18, "resolut": 18, "less": 18, "than": [18, 22], "resolution_tol": 18, "distinguish": 18, "arr1": 18, "metacel": 18, "finish": 18, "arr2": 18, "whose": 18, "so": 18, "24": 18, "25": [18, 21, 22], "find_initial_pivot": 18, "pair": 18, "wt1": 18, "wt2": 18, "done": 18, "store": 18, "intern": 18, "field": 18, "_init_match": 18, "invis": 18, "canon": 18, "correl": 18, "best": 18, "cca": 18, "plot_canonical_correl": 18, "50": [18, 21, 22], "cca_compon": 18, "quick": 18, "previou": 18, "give": 18, "rough": 18, "guid": 18, "what": 18, "refine_pivot": 18, "pick": 18, "note": 18, "n_iter": 18, "snr": 18, "omi": 18, "increas": 18, "amount": 18, "might": 18, "degrad": 18, "randomized_svd": 18, "svd_run": 18, "filter_prop": 18, "compar": 18, "harsher": 18, "benefici": 18, "filter_bad_match": 18, "16245": 18, "32485": 18, "remain": 18, "score": 18, "9567": 18, "u": 18, "full": 18, "awai": 18, "few": 18, "scenario": 18, "would": 18, "prefer": 18, "accross": 18, "howev": 18, "case": 18, "invovl": 18, "noisi": 18, "lack": 18, "downstream": 18, "suggest": 18, "around": 18, "31": 18, "125238": 18, "178914": 18, "get_match": 18, "full_data": 18, "duplic": 18, "those": 18, "dealt": 18, "noth": 18, "potenti": 18, "least": [18, 22], "full_match": 18, "141438": 18, "mod": 18, "could": [18, 22], "33": [18, 20], "mod1_indx": 18, "mod2_indx": 18, "idx": 18, "mod1": 18, "mod2": 18, "11555": 18, "677698": 18, "12419": 18, "829264": 18, "6964": 18, "743796": 18, "12027": 18, "35": 18, "633725": 18, "3463": 18, "38": 18, "873877": 18, "141433": 18, "6516": 18, "178913": 18, "650691": 18, "141434": 18, "6380": 18, "178915": 18, "752489": 18, "141435": 18, "11798": 18, "178916": 18, "624662": 18, "141436": 18, "178917": 18, "598526": 18, "141437": 18, "6253": 18, "178918": 18, "721950": 18, "df_re": 18, "to_csv": 18, "tonsil_codex_rna": 18, "protein_exp": 18, "feature_label": 18, "unique_feature_label": 18, "multiomics_spati": 18, "get_spatial_knn_indic": 18, "cell_nbhd": 18, "get_neighborhood_composit": 18, "n_cluster": 18, "random_st": 18, "labels_": 18, "cluster_composit": 18, "astyp": [18, 21, 22], "cell_type_ord": 18, "order_clusters_composit": 18, "hue_ord": 18, "raster": 18, "tick_param": 18, "labels": 18, "left": 18, "get_titl": 18, "set_fonts": 18, "get_text": 18, "tonsil_ct_composit": 18, "png": 18, "300": 18, "avg_exp": 18, "get_avg_expression_neighbor": 18, "avg_exp_df": 18, "avg": 18, "00": 18, "5944": 18, "59it": 18, "kmeans_protein": 18, "cluster_protein": 18, "reorder": 18, "consist": [18, 21], "order_clusters_protein": 18, "cluster_protein_ord": 18, "index1": 18, "index2": 18, "index3": 18, "index4": 18, "index5": 18, "index6": 18, "index7": 18, "index8": 18, "palett": [18, 23], "bright": 18, "tonsil_avgprotein_ord": 18, "df_rna_match": 18, "2000": 18, "rna_exp": 18, "rna_match": 18, "desc": 18, "rna_idx": 18, "rna_exp_each": 18, "5625": 18, "78it": 18, "rna_matched_protein_ord": 18, "rna_matched_df": 18, "avg_exp_rna": 18, "avg_exp_rna_df": 18, "3908": 18, "42it": 18, "kmeans_rna": 18, "cluster_rna": 18, "order_clusters_rna": 18, "cluster_rna_ord": 18, "index9": 18, "index10": 18, "tonsil_avgrna_ord": 18, "all_protein": 18, "cluster_avg_exp": 18, "scaler": 18, "rna_matched_protein_order_scal": 18, "fit_transform": 18, "all_rna": 18, "cluster_avg_exp_rna": 18, "var_rna": 18, "top_variance_column": 18, "sort_valu": 18, "ascend": 18, "top_variance_column_nam": 18, "cluster_avg_exp_rna_vari": 18, "were": 18, "reveal": 18, "despit": 18, "discern": 18, "focal": 18, "intens": 18, "makeup": 18, "cd74": 18, "tuba1b": 18, "These": 18, "variat": 18, "known": 18, "subpopul": 18, "germin": 18, "comb_df": 18, "concat": 18, "fg": 18, "clustermap": 18, "row_clust": 18, "col_clust": 18, "cax": 18, "yaxi": 18, "set_tick_param": 18, "ax_heatmap": 18, "set_yticklabel": 18, "get_yticklabel": 18, "set_xticklabel": 18, "get_xticklabel": 18, "tonsil_protein_neighborhood_heatmap": 18, "unittest": [19, 20, 21, 22], "mock": [19, 20], "class": [19, 20, 21, 22], "testcalculatemdi": 19, "testcas": [19, 20, 21, 22], "def": [19, 20, 21, 22], "setup": 19, "self": [19, 20, 21, 22], "up": [19, 20, 21, 22], "rand": [19, 21, 22], "sample_1": [19, 20, 21, 22], "2500": [19, 21], "sample_2": [19, 20, 22], "randint": [19, 21, 22], "expected_index": 19, "expected_column": 19, "test_calculate_mdi_with_random_patch_fals": 19, "assertisinst": [19, 20, 21, 22], "assertlistequ": 19, "verifi": 19, "exist": 19, "numer": [19, 21, 22], "assertin": [19, 20], "asserttru": [19, 22], "issubdtyp": 19, "test_calculate_mdi_with_random_patch_tru": 19, "result_random": 19, "notebook": [19, 20, 21, 22], "argv": [19, 20, 21, 22], "arg": [19, 20, 21, 22], "exit": [19, 20, 21, 22], "320548430536853": 19, "318675527712075": 19, "3157615698139944": 19, "3098586262794134": 19, "2738724660974885": 19, "2712741280351403": 19, "1357805949294244": 19, "136249663683922": 19, "5571428571428572": 19, "6714285714285715": 19, "319397130221288": 19, "3198048602087438": 19, "311824991920736": 19, "3127017488287462": 19, "2742115498481206": 19, "280909902805943": 19, "1625338119527555": 19, "153896959644078": 19, "ran": [19, 20, 21, 22], "ok": [19, 20, 21, 22], "testprogram": [19, 20, 21, 22], "0x150b6c9d0": 19, "testcalculatediversityindex": 20, "classmethod": [20, 21, 22], "setupclass": [20, 21, 22], "cl": [20, 21, 22], "among": 20, "cell1": 20, "cell2": 20, "cell3": 20, "cell4": 20, "cell5": 20, "df": [20, 21], "x_coord": 20, "y_coord": 20, "test_calculate_diversity_index_with_adata": 20, "assert": 20, "expected_entropy_patch0": 20, "calculate_shannon_entropi": 20, "assertalmostequ": [20, 21, 22], "assertnotin": 20, "expected_entropy_patch2": 20, "assertequ": [20, 21, 22], "test_calculate_diversity_index_with_datafram": 20, "test_invalid_metr": 20, "invalid": [20, 21, 22], "assertrais": [20, 21, 22], "valueerror": [20, 21, 22], "unknown": 20, "except": 20, "test_invalid_spatial_data": 20, "invalid_data": 20, "test_missing_cluster_kei": 20, "adata_missing_clust": 20, "inplac": [20, 21, 22], "test_empty_patch": 20, "empty_patch": 20, "test_return_comp_tru": 20, "result_seri": 20, "to_dict": 20, "assertisnon": 20, "test_metric_simpson": 20, "simpson": 20, "expected_simpson_patch0": 20, "calculate_simpson_index": 20, "expected_simpson_patch2": 20, "test_metric_simpson_divers": 20, "expected_simpson_diversity_patch0": 20, "calculate_simpsondiversity_index": 20, "expected_simpson_diversity_patch2": 20, "_core": 20, "implicitmodificationwarn": 20, "transform": 20, "082": 20, "333": 20, "0x151d4a150": 20, "testgeneratepatch": 21, "total_point": [21, 22], "spatial_coord": 21, "test_generate_patches_with_anndata": 21, "expected_patch": [21, 22], "2x2": 21, "test_generate_patches_with_datafram": 21, "5x5": [21, 22], "test_invalid_spatial_data_typ": [21, 22], "invalid_typ": [21, 22], "test_invalid_library_kei": [21, 22], "keyerror": [21, 22], "invalid_kei": [21, 22], "test_invalid_library_id": [21, 22], "invalid_id": [21, 22], "test_invalid_spatial_kei": [21, 22], "invalid_spatial_kei": [21, 22], "test_zero_scaling_factor": [21, 22], "test_non_numeric_scaling_factor": [21, 22], "typeerror": [21, 22], "test_empty_spatial_data_filt": [21, 22], "spatial_data_filt": [21, 22], "non_exist": [21, 22], "test_output_patch_coordin": 21, "min_coord": [21, 22], "max_coord": [21, 22], "expected_patch_width": [21, 22], "expected_patch_height": [21, 22], "cover": 21, "correctli": 21, "ipykernel_85830": 21, "3363036317": 21, "141": 21, "__getitem__": 21, "treat": 21, "futur": 21, "integ": 21, "alwai": 21, "behavior": 21, "ser": 21, "po": 21, "055": 21, "0x158b78950": 21, "testgeneratepatchesrandomli": 22, "df_sample1": 22, "test_generate_patches_randomly_with_anndata": 22, "max_overlap": 22, "test_generate_patches_randomly_with_datafram": 22, "test_output_patch_s": 22, "place": 22, "test_max_overlap": 22, "overlap": 22, "patch1": 22, "patch2": 22, "overlap_check": 22, "overlap_allow": 22, "_overlap_check": 22, "new_patch": 22, "existing_patch": 22, "max_overlap_ratio": 22, "test_min_point": 22, "test_random_seed_consist": 22, "patches1": 22, "patches2": 22, "test_contains_min_point": 22, "_contains_point": 22, "0x15ba4a150": 22, "customis": 23, "circl": 23, "multiom": 23, "ii": 23, "initi": 23, "pivot": 23, "iii": 23, "refin": 23, "iv": 23, "propag": 23, "character": 23, "protein": 23, "mrna": 23, "generate_patches_randomli": 24}, "objects": {"mesa": [[0, 0, 0, "-", "ecospatial"]], "mesa.ecospatial": [[1, 1, 1, "", "calculate_DPI"], [2, 1, 1, "", "calculate_GDI"], [3, 1, 1, "", "calculate_MDI"], [4, 1, 1, "", "calculate_diversity_index"], [5, 1, 1, "", "calculate_shannon_entropy"], [6, 1, 1, "", "diversity_heatmap"], [7, 1, 1, "", "generate_patches"], [8, 1, 1, "", "global_spatial_stats"], [9, 1, 1, "", "local_spatial_stats"], [10, 1, 1, "", "spot_cellfreq"]], "mesa.multiomics": [[0, 0, 0, "-", "multiomics_spatial"]], "mesa.multiomics.multiomics_spatial": [[11, 1, 1, "", "get_avg_expression_neighbors"], [12, 1, 1, "", "get_neighborhood_composition"], [13, 1, 1, "", "get_spatial_knn_indices"]]}, "objtypes": {"0": "py:module", "1": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"]}, "titleterms": {"api": 0, "multiom": [0, 11, 12, 13, 14, 18], "ecospati": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 17], "mesa": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18], "calculate_dpi": 1, "calculate_gdi": 2, "calculate_mdi": [3, 19], "calculate_diversity_index": [4, 20], "calculate_shannon_entropi": 5, "diversity_heatmap": 6, "generate_patch": [7, 21], "global_spatial_stat": 8, "local_spatial_stat": 9, "spot_cellfreq": 10, "multiomics_spati": [11, 12, 13], "get_avg_expression_neighbor": 11, "get_neighborhood_composit": 12, "get_spatial_knn_indic": 13, "ecolog": 14, "spatial": 14, "analysi": [14, 17], "quantit": 14, "decod": 14, "tissu": 14, "diseas": 14, "state": 14, "python": 14, "get": 14, "start": 14, "licens": 14, "instal": 15, "pypi": 15, "us": 16, "r": 16, "load": 16, "packag": 16, "read": [16, 17], "prepar": [16, 18], "data": [16, 17, 18], "calcul": [16, 17], "mdi": [16, 17], "perform": [16, 17], "statist": 16, "test": [16, 19, 20, 21, 22], "plot": [16, 17], "result": 16, "tutori": [17, 18, 23], "customis": 17, "color": 17, "palett": 17, "one": 17, "sampl": 17, "divers": 17, "heatmap": [17, 18], "relat": 17, "all": 17, "gdi": 17, "dpi": 17, "global": 17, "cell": 17, "frequenc": 17, "co": 17, "occurr": 17, "hot": 17, "coldspot": 17, "process": 17, "datafram": 17, "circl": 17, "integr": 18, "step": 18, "i": 18, "ii": 18, "find": 18, "initi": 18, "pivot": 18, "iii": 18, "refin": 18, "iv": 18, "propag": 18, "neighborhood": 18, "character": 18, "cellular": 18, "composit": 18, "base": 18, "": 18, "local": 18, "averag": 18, "protein": 18, "express": 18, "mrna": 18, "unit": [19, 20, 21, 22], "generate_patches_randomli": 22, "unittest": 24}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "nbsphinx": 4, "sphinx": 60}, "alltitles": {"API": [[0, "api"]], "Multiomics": [[0, "module-mesa.multiomics.multiomics_spatial"]], "Ecospatial": [[0, "module-mesa.ecospatial"]], "mesa.ecospatial.calculate_DPI": [[1, "mesa-ecospatial-calculate-dpi"]], "mesa.ecospatial.calculate_GDI": [[2, "mesa-ecospatial-calculate-gdi"]], "mesa.ecospatial.calculate_MDI": [[3, "mesa-ecospatial-calculate-mdi"]], "mesa.ecospatial.calculate_diversity_index": [[4, "mesa-ecospatial-calculate-diversity-index"]], "mesa.ecospatial.calculate_shannon_entropy": [[5, "mesa-ecospatial-calculate-shannon-entropy"]], "mesa.ecospatial.diversity_heatmap": [[6, "mesa-ecospatial-diversity-heatmap"]], "mesa.ecospatial.generate_patches": [[7, "mesa-ecospatial-generate-patches"]], "mesa.ecospatial.global_spatial_stats": [[8, "mesa-ecospatial-global-spatial-stats"]], "mesa.ecospatial.local_spatial_stats": [[9, "mesa-ecospatial-local-spatial-stats"]], "mesa.ecospatial.spot_cellfreq": [[10, "mesa-ecospatial-spot-cellfreq"]], "mesa.multiomics.multiomics_spatial.get_avg_expression_neighbors": [[11, "mesa-multiomics-multiomics-spatial-get-avg-expression-neighbors"]], "mesa.multiomics.multiomics_spatial.get_neighborhood_composition": [[12, "mesa-multiomics-multiomics-spatial-get-neighborhood-composition"]], "mesa.multiomics.multiomics_spatial.get_spatial_knn_indices": [[13, "mesa-multiomics-multiomics-spatial-get-spatial-knn-indices"]], "MESA - Multiomics and Ecological Spatial Analysis for Quantitative Decoding of Tissue Disease States in Python": [[14, "mesa-multiomics-and-ecological-spatial-analysis-for-quantitative-decoding-of-tissue-disease-states-in-python"]], "Getting started with MESA": [[14, "getting-started-with-mesa"]], "License": [[14, "license"]], "Installation": [[15, "installation"]], "PyPI": [[15, "pypi"]], "Using MESA in R": [[16, "using-mesa-in-r"]], "Loading Packages": [[16, "loading-packages"]], "Read and prepare data": [[16, "read-and-prepare-data"]], "Calculate MDI": [[16, "calculate-mdi"], [17, "Calculate-MDI"], [17, "id1"]], "Perform statistical test and plot results": [[16, "perform-statistical-test-and-plot-results"]], "MESA Ecospatial Tutorials": [[17, "MESA-Ecospatial-Tutorials"]], "Read Data": [[17, "Read-Data"]], "Customise color palette": [[17, "Customise-color-palette"]], "Perform Ecospatial Analysis on one sample": [[17, "Perform-Ecospatial-Analysis-on-one-sample"]], "Diversity Heatmap Related Analysis": [[17, "Diversity-Heatmap-Related-Analysis"]], "Perform Ecospatial Analysis on all samples": [[17, "Perform-Ecospatial-Analysis-on-all-samples"]], "Calculate GDI": [[17, "Calculate-GDI"]], "Calculate DPI": [[17, "Calculate-DPI"]], "Calculate Global Cell Frequency & Cell Co-Occurrence": [[17, "Calculate-Global-Cell-Frequency-&-Cell-Co-Occurrence"]], "Calculate Cell Frequency and Cell Co-Occurrence in hot/coldspots": [[17, "Calculate-Cell-Frequency-and-Cell-Co-Occurrence-in-hot/coldspots"]], "Process Cell Co-Occurrence Dataframe": [[17, "Process-Cell-Co-Occurrence-Dataframe"]], "Cell Co-Occurrence Circle Plot": [[17, "Cell-Co-Occurrence-Circle-Plot"]], "MESA Multiomics Tutorials": [[18, "MESA-Multiomics-Tutorials"]], "Prepare Data for Multiomics Integration": [[18, "Prepare-Data-for-Multiomics-Integration"]], "Multiomics Integration": [[18, "Multiomics-Integration"]], "Step I: preparations": [[18, "Step-I:-preparations"]], "Step II: finding initial pivots": [[18, "Step-II:-finding-initial-pivots"]], "Step III: finding refined pivots": [[18, "Step-III:-finding-refined-pivots"]], "Step IV: propagation": [[18, "Step-IV:-propagation"]], "Neighborhood Characterization": [[18, "Neighborhood-Characterization"]], "Cellular Composition-based Neighborhoods": [[18, "Cellular-Composition-based-Neighborhoods"]], "MESA\u2019s Local Average Protein Expression-based Neighborhoods": [[18, "MESA's-Local-Average-Protein-Expression-based-Neighborhoods"]], "MESA\u2019s Local Average mRNA Expression-based Neighborhoods": [[18, "MESA's-Local-Average-mRNA-Expression-based-Neighborhoods"]], "Neighborhood Heatmap": [[18, "Neighborhood-Heatmap"]], "Unit Test for Calculate_MDI": [[19, "Unit-Test-for-Calculate_MDI"]], "Unit Test for calculate_diversity_index": [[20, "Unit-Test-for-calculate_diversity_index"]], "Unit Test for generate_patches": [[21, "Unit-Test-for-generate_patches"]], "Unit Test for generate_patches_randomly": [[22, "Unit-Test-for-generate_patches_randomly"]], "Tutorials": [[23, "tutorials"]], "UnitTest": [[24, "unittest"]]}, "indexentries": {"mesa.ecospatial": [[0, "module-mesa.ecospatial"]], "mesa.multiomics.multiomics_spatial": [[0, "module-mesa.multiomics.multiomics_spatial"]], "module": [[0, "module-mesa.ecospatial"], [0, "module-mesa.multiomics.multiomics_spatial"]], "calculate_dpi() (in module mesa.ecospatial)": [[1, "mesa.ecospatial.calculate_DPI"]], "calculate_gdi() (in module mesa.ecospatial)": [[2, "mesa.ecospatial.calculate_GDI"]], "calculate_mdi() (in module mesa.ecospatial)": [[3, "mesa.ecospatial.calculate_MDI"]], "calculate_diversity_index() (in module mesa.ecospatial)": [[4, "mesa.ecospatial.calculate_diversity_index"]], "calculate_shannon_entropy() (in module mesa.ecospatial)": [[5, "mesa.ecospatial.calculate_shannon_entropy"]], "diversity_heatmap() (in module mesa.ecospatial)": [[6, "mesa.ecospatial.diversity_heatmap"]], "generate_patches() (in module mesa.ecospatial)": [[7, "mesa.ecospatial.generate_patches"]], "global_spatial_stats() (in module mesa.ecospatial)": [[8, "mesa.ecospatial.global_spatial_stats"]], "local_spatial_stats() (in module mesa.ecospatial)": [[9, "mesa.ecospatial.local_spatial_stats"]], "spot_cellfreq() (in module mesa.ecospatial)": [[10, "mesa.ecospatial.spot_cellfreq"]], "get_avg_expression_neighbors() (in module mesa.multiomics.multiomics_spatial)": [[11, "mesa.multiomics.multiomics_spatial.get_avg_expression_neighbors"]], "get_neighborhood_composition() (in module mesa.multiomics.multiomics_spatial)": [[12, "mesa.multiomics.multiomics_spatial.get_neighborhood_composition"]], "get_spatial_knn_indices() (in module mesa.multiomics.multiomics_spatial)": [[13, "mesa.multiomics.multiomics_spatial.get_spatial_knn_indices"]]}})